(function(t){function e(e){for(var a,i,r=e[0],c=e[1],l=e[2],d=0,f=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&f.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},s={app:0},o=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0b66":function(t,e,n){"use strict";n("e6cd")},"3a14":function(t,e,n){"use strict";n("98c4")},4127:function(t,e,n){},4678:function(t,e,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}s.keys=function(){return Object.keys(a)},s.resolve=o,t.exports=s,s.id="4678"},"4d8b":function(t,e,n){"use strict";n("a7d3")},"516d":function(t,e,n){"use strict";n("adf7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view"),t.showMobileMenu?n("mobile-menu"):t._e(),t.showLoading?n("Loading"):t._e()],1)},o=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"loading-wrap"},[n("svg",{staticClass:"spinner",attrs:{width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{staticClass:"path",attrs:{fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"}})])])},r=[],c={},l=c,u=(n("cf19"),n("2877")),d=Object(u["a"])(l,i,r,!1,null,"ef0ba8b8",null),f=d.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-screen overflow-hidden md:hidden"},[t.active?n("div",{staticClass:"fixed w-screen h-screen top-0 left-0 z-50"},[n("div",{staticClass:"mask"}),n("nav",{staticClass:"\n                menu\n                overflow-hidden\n                fixed\n                right-0\n                top-0\n                w-60\n                gradients-dark\n                z-30\n            "},[n("ul",{staticClass:"\n                    menu-list\n                    absolute\n                    pt-16\n                    pr-48\n                    top-16\n                    rounded-full\n                    gradients\n                "},t._l(t.menuList,(function(e){return n("li",{key:e.path,staticClass:"text-white pr-40 py-4 text-right text-lg",on:{click:function(n){return t.goPath(e.path)}}},[t._v(" "+t._s(e.name)+" ")])})),0)])]):t._e(),t.showHam?n("div",{class:["mobile-menu-btn",{active:t.active}],on:{click:t.ctrlMenu}},[t._m(0),n("img",{staticClass:"absolute h-8 w-8 top-12 left-0",attrs:{src:"images/header/HeadMenu-quarter-"+(t.active?"W":"P")+"_mobile.svg",alt:""}})]):t._e()])},m=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hamburger"},[n("span",{staticClass:"line"}),n("span",{staticClass:"line"}),n("span",{staticClass:"line"})])}],h={data:function(){return{menuList:[{name:"回首頁",path:"/"},{name:"公車快找",path:"/bussearch"},{name:"查詢公車",path:"/busnear"},{name:"我的最愛",path:"/favorite"}],active:!1,showHam:!0}},methods:{ctrlMenu:function(){this.active=!this.active},goPath:function(t){this.$router.push(t),this.active=!1}},mounted:function(){this.showHam="/"!==this.$route.path}},v=h,b=(n("fc16"),Object(u["a"])(v,p,m,!1,null,"7558c220",null)),g=b.exports,y={components:{Loading:f,MobileMenu:g},watch:{$route:{immediate:!0,handler:function(t){this.showMobileMenu="/"!==t.path}}},data:function(){return{showLoading:!1,showMobileMenu:!1,windowSize:0}},created:function(){var t=this;this.$bus.$on("setLoading",(function(e){t.showLoading=e}))},methods:{resizeEvent:function(){this.windowSize=window.innerWidth}},mounted:function(){this.windowSize=window.innerWidth,window.addEventListener("resize",this.resizeEvent)},beforeDestroy:function(){this.$bus.$off("setLoading"),window.removeEventListener("resize",this.resizeEvent)},provide:function(){var t=this,e={};return Object.defineProperty(e,"windowSize",{get:function(){return t.windowSize}}),{appData:e}}},w=y,x=(n("034f"),Object(u["a"])(w,s,o,!1,null,null,null)),k=x.exports,j=n("8c4f"),S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("Header"),n("div",{staticClass:"px-4"},[n("index-menu")],1),n("map-index",{ref:"mapIndex"}),n("near-stop",{on:{setNowPos:t.setNowPos,drawStation:t.drawStation}}),n("Footer")],1)},L=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return!t.isMobile||t.isMobile&&t.isIndex?n("footer",{staticClass:"\n        bg-primary-700\n        h-9\n        fixed\n        bottom-0\n        flex\n        justify-center\n        items-center\n        text-white\n        z-50\n        md:right-0\n    "},[t._v(" The F2E 3rd Week3 - Bus ")]):t._e()},I=[],N={inject:["appData"],computed:{isMobile:function(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},data:function(){return{isIndex:!1}},mounted:function(){"/"===this.$route.path&&(this.isIndex=!0)}},C=N,D=(n("de35"),Object(u["a"])(C,_,I,!1,null,null,null)),O=D.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return!t.isMobile||t.isMobile&&t.isIndex?n("header",{staticClass:"\n        gradients-deep\n        flex flex-wrap\n        justify-center\n        items-center\n        relative\n        h-24\n        w-full\n        text-white\n        md:h-20 md:justify-between\n    ",class:t.setClass},[t._m(0),n("ul",{staticClass:"\n            hidden\n            md:flex md:justify-end\n            justify-center\n            items-center\n            pr-12\n            w-2/5\n        "},t._l(t.menuList,(function(e){return n("li",{key:e.path,staticClass:"\n                text-white\n                cursor-pointer\n                text-lg\n                md:mr-3\n                hover:text-purple-200\n            ",on:{click:function(n){return t.goPath(e.path)}}},[t._v(" "+t._s(e.name)+" ")])})),0),n("img",{staticClass:"absolute top-1 left-1 md:h-16 md:left-3",attrs:{src:"images/Index-header-logo.svg",alt:""},on:{click:function(e){return t.goPath("/")}}}),n("img",{staticClass:"absolute bottom-0 right-0",attrs:{src:"images/Index-header-quarter.svg",alt:""}})]):t._e()},M=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"w-full text-2xl text-left pl-24 md:w-2/5"},[t._v(" 機智公車族 "),n("p",{staticClass:"text-base"},[t._v("全台公車動態時刻查詢應用服務")])])}],R={inject:["appData"],props:{setClass:{type:String,default:""}},data:function(){return{menuList:[{name:"公車快找",path:"/bussearch"},{name:"查詢公車",path:"/busnear"},{name:"我的最愛",path:"/favorite"}],showHeader:!1,isIndex:!1}},computed:{isMobile:function(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},methods:{goPath:function(t){this.$router.push(t)}},mounted:function(){"/"===this.$route.path&&(this.isIndex=!0)}},$=R,T=(n("4d8b"),Object(u["a"])($,P,M,!1,null,null,null)),B=T.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"mt-8 md:fixed md:w-96 md:right-0 top-32 z-50 md:cursor-pointer"},[n("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/bussearch")}}},[t._m(0),n("img",{attrs:{src:"images/Index-section-image04_m.svg",alt:""}})]),n("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/busnear")}}},[t._m(1),n("img",{attrs:{src:"images/Index-section-image01_m.svg",alt:""}})]),n("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/favorite")}}},[t._m(2),n("img",{attrs:{src:"images/Index-section-image02_m.svg",alt:""}})])])},z=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"w-2/3 text-left"},[n("span",{staticClass:"text-lg font-bold block text-black"},[t._v("公車快找")]),n("span",{staticClass:"text-gray-600 text-sm"},[t._v("直接輸入路線名稱獲得資訊！")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"w-2/3 text-left"},[n("span",{staticClass:"text-lg font-bold block text-black"},[t._v("查詢站牌")]),n("span",{staticClass:"text-gray-600 text-sm"},[t._v("附近站牌 / 公車動態及路線圖")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"w-2/3 text-left"},[n("span",{staticClass:"text-lg font-bold block text-black"},[t._v("我的最愛")]),n("span",{staticClass:"text-gray-600 text-sm"},[t._v("將常用路線加入我的最愛吧！")])])}],U={methods:{goPath:function(t){this.$router.push(t)}}},Z=U,A=(n("0b66"),Object(u["a"])(Z,E,z,!1,null,"1e5c2f5c",null)),F=A.exports,Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"for-web",attrs:{id:"map"}})},H=[],K=(n("d81d"),n("99af"),n("c1df"),n("e11e")),V=n.n(K),q=function(t,e,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"K";if(t==n&&e==a)return 0;var o=Math.PI*t/180,i=Math.PI*n/180,r=e-a,c=Math.PI*r/180,l=Math.sin(o)*Math.sin(i)+Math.cos(o)*Math.cos(i)*Math.cos(c);return l>1&&(l=1),l=Math.acos(l),l=180*l/Math.PI,l=60*l*1.1515,"K"==s&&(l*=1.609344),"N"==s&&(l*=.8684),l},G=function(t){return Math.floor(t/60)},J=function(t){var e=t.EstimateTime,n=t.StopStatus,a=G(e),s={1:"尚未發車",2:"交管不停靠",3:"末班車已過",4:"今日未營運"};if(0!==n)return"<span class='bg-gray-500 text-white text-sm p-2 mr-2 rounded-md'>".concat(s[n],"</span>");var o="";switch(!0){case 0===a:o="<span class='red'>進站中</span>";break;case a<=1&&0<a:o="<span class='red'>即將到站</span>";break;default:o='<span class="font-bold text-lg px-2">'.concat(a,'</span><span class="font-normal">分</span>');break}return o},W=function(){return new V.a.markerClusterGroup({showCoverageOnHover:!1,spiderfyOnMaxZoom:!0,zoomToBoundsOnClick:!0,argumentsspiderfyOnMaxZoom:!1,maxClusterRadius:120,iconCreateFunction:function(t){var e=t.getAllChildMarkers(),n=" marker-cluster-";n+=e<10?"small":e<100?"medium":"large";var a='\n                    <div class="group">\n                        <span>\n                            '.concat(e.length,"\n                        </span>\n                    </div>\n                    ");return new V.a.DivIcon({html:a,className:"marker-cluster"+n,iconSize:new V.a.Point(40,40)})}})},Q=null,X=null,tt=null,et=null,nt={data:function(){return{}},methods:{createMap:function(){var t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Q=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(Q);var e=W();X=(new V.a.MarkerClusterGroup).addTo(Q),tt=e.addTo(Q),this.setView(25.033876641528444,121.56456344001262)},cleanMarker:function(){X.clearLayers(),Q.eachLayer((function(t){t instanceof V.a.Marker&&Q.removeLayer(t)}))},cleanStation:function(){tt.clearLayers()},setView:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;Q.setView([t,e],n)},createMark:function(){et=new V.a.Icon({iconUrl:"images/mark/TrackingSpot.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawSelfMark:function(t,e){X.addLayer(V.a.marker([t,e],{icon:et})),Q.addLayer(X),this.setView(t,e)},drawStation:function(t,e,n){this.cleanStation(),tt.addLayer(V.a.marker([t,e],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:'\n                        <div class="w-24 h-14 relative">\n                            <p class="text-light font-bold text-sm text-center relative z-10 p-2 bg-primary-700 rounded-lg m-auto">\n                                '.concat(n.Zh_tw,'\n                            </p>\n                            <img class="w-9 m-auto" src="images/mark/BusStop.svg"/>\n                        </div>')})}).on("click",this.markerOnClick)),Q.addLayer(tt)}},mounted:function(){this.createMark(),this.createMap()},beforeDestroy:function(){Q=null,X=null,tt=null}},at=nt,st=Object(u["a"])(at,Y,H,!1,null,"6ac9f12d",null),ot=st.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"near-stop side-block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showList,expression:"!showList"}],staticClass:"pos-btn px-4 md:py-4"},[n("p",{staticClass:"text-center text-md font-bold block text-black pt-6"},[t._v(" 開啟裝置定位功能，以便為您提供更好的服務。 ")]),n("p",{staticClass:"text-center text-sm text-primary-700 pb-2"},[t._v(" 我們將用在提供您所在位置附近的交通等資訊。 ")]),n("button",{staticClass:"\n                border-2\n                w-full\n                h-12\n                text-primary-500\n                border-primary-500\n                rounded-3xl\n            ",on:{click:t.getNowPos}},[t._v(" 開啟定位功能 ")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"near-list bg-light mt-8 py-4 px-4 pb-16 min-h"},[n("p",{staticClass:"text-sm text-left py-2 font-bold text-gray-500"},[t._v(" 最近站牌 ")]),n("div",{staticClass:"flex items-center justify-between"},[n("p",{staticClass:"font-bold text-lg"},[t._v(" "+t._s(t.nearStop.StationName&&t.nearStop.StationName.Zh_tw)+" ")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.timeList.length>0,expression:"timeList.length > 0"}],staticClass:"text-sm text-left font-bold text-gray-500"},[t._v("將於"+t._s(t.second)+"秒後更新 "),n("img",{staticClass:"inline cursor-pointer",attrs:{src:"images/Refresh.svg",alt:""},on:{click:t.refresh}})])]),n("ul",{staticClass:"stop-list overflow-y-scroll"},[t._l(t.sortedTimeList,(function(t){return[n("bus-near-estimate-item",{key:t.StopUID,attrs:{itemData:t}})]})),n("li",{directives:[{name:"show",rawName:"v-show",value:0===t.sortedTimeList.length,expression:"sortedTimeList.length === 0"}],staticClass:"no-data"},[t._v(" 附近無站牌 ")])],2)])])},rt=[],ct=n("53ca"),lt=n("3835"),ut=n("1da1"),dt=n("2909"),ft=n("5530"),pt=(n("96cf"),n("4e82"),n("4de4"),n("d3b7"),n("caad"),n("3ca3"),n("ddb0"),n("7db0"),n("2f62")),mt="https://ptx.transportdata.tw/MOTC/v2/Bus",ht=mt+"/Route/City",vt=mt+"/Shape/City",bt=mt+"/RealTimeByFrequency/City",gt=mt+"/RealTimeNearStop/City",yt=mt+"/StopOfRoute/City",wt=mt+"/Station/NearBy",xt=mt+"/EstimatedTimeOfArrival/City",kt=mt+"/EstimatedTimeOfArrival/NearBy",jt=[{ISO:"TPE",label:"臺北市",value:"Taipei",pos:{lat:25.03387664152844,lon:121.56456344001262}},{ISO:"NWT",label:"新北市",value:"NewTaipei",pos:{lat:25.014174781858774,lon:121.4643227956334}},{ISO:"TAO",label:"桃園市",value:"Taoyuan",pos:{lat:24.989124198332156,lon:121.31437562494263}},{ISO:"TXG",label:"臺中市",value:"Taichung",pos:{lat:24.140781058069635,lon:120.68812172254115}},{ISO:"TNN",label:"臺南市",value:"Tainan",pos:{lat:"",lon:""}},{ISO:"KHH",label:"高雄市",value:"Kaohsiung",pos:{lat:22.639670623239073,lon:120.3025722690854}},{ISO:"KEE",label:"基隆市",value:"Keelung",pos:{lat:25.133215692889234,lon:121.73933982864644}},{ISO:"HSZ",label:"新竹市",value:"Hsinchu",pos:{lat:24.801743512239355,lon:120.97163121329774}},{ISO:"HSQ",label:"新竹縣",value:"HsinchuCounty",pos:{lat:24.827112878570077,lon:121.01288224028333}},{ISO:"MIA",label:"苗栗縣",value:"MiaoliCounty",pos:{lat:24.565011108542414,lon:120.82076045562239}},{ISO:"CHA",label:"彰化縣",value:"ChanghuaCounty",pos:{lat:24.081710829901592,lon:120.5385152286296}},{ISO:"NAN",label:"南投縣",value:"NantouCounty",pos:{lat:23.830413252257117,lon:120.78477508413482}},{ISO:"YUN",label:"雲林縣",value:"YunlinCounty",pos:{lat:"",lon:""}},{ISO:"CYQ",label:"嘉義縣",value:"ChiayiCounty",pos:{lat:"",lon:""}},{ISO:"CYI",label:"嘉義市",value:"Chiayi",pos:{lat:23.54424978420921,lon:120.43208978444218}},{ISO:"PIF",label:"屏東縣",value:"PingtungCounty",pos:{lat:23.47933335484157,lon:120.4411223114263}},{ISO:"ILA",label:"宜蘭縣",value:"YilanCounty",pos:{lat:24.754605871450718,lon:121.75814781144638}},{ISO:"HUA",label:"花蓮縣",value:"HualienCounty",pos:{lat:24.039062872284244,lon:121.59699137334108}},{ISO:"TTT",label:"臺東縣",value:"TaitungCounty",pos:{lat:22.79389716809124,lon:121.12339618813223}},{ISO:"KIN",label:"金門縣",value:"KinmenCounty",pos:{lat:24.448677292829426,lon:118.32266374397871}},{ISO:"PEN",label:"澎湖縣",value:"PenghuCounty",pos:{lat:23.571795417402495,lon:119.57745233271699}},{ISO:"LIE",label:"連江縣",value:"LienchiangCounty",pos:{lat:26.15799750356264,lon:119.95197324215599}}],St=(n("b64b"),n("bc3a")),Lt=n.n(St),_t=Lt.a.create({});_t.interceptors.request.use((function(t){var e=t.params;return Object.keys(e).map((function(t){e[t]||delete e[t]})),t}),(function(t){return t})),_t.interceptors.response.use((function(t){return t.data}),(function(t){var e=t.response.status;return console.log("error--".concat(e),"error"),Promise.reject(t)}));var It=_t,Nt=n("6c2d"),Ct=function(){var t="b65665fcca144956a79d25bb3edc7b34",e="daVxLDO01nPgTTwhQKVBmY-pjeQ",n=(new Date).toGMTString(),a=new Nt["a"]("SHA-1","TEXT");a.setHMACKey(e,"TEXT"),a.update("x-date: "+n);var s=a.getHMAC("B64"),o='hmac username="'.concat(t,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(s,'"');return{Authorization:o,"X-Date":n,"Content-Type":"application/x-www-form-urlencoded"}},Dt=function(t){var e=t.city,n=void 0===e?"":e,a=t.routeName,s=void 0===a?"":a;return delete t.city,delete t.routeName,{cityPath:n,routeName:s,data:t}},Ot=function(t){var e=Dt(t),n=e.cityPath,a=e.routeName,s=void 0===a?"":a,o=e.data,i={headers:Ct(),params:Object(ft["a"])({},o)};return It.get(ht+"/".concat(n,"/").concat(s),i)},Pt=function(t){var e=Dt(t),n=e.cityPath,a=e.routeName,s=void 0===a?"":a,o=e.data,i={headers:Ct(),params:Object(ft["a"])({},o)};return It.get(yt+"/".concat(n,"/").concat(s),i)},Mt=function(t){var e=Dt(t),n=e.cityPath,a=e.routeName,s=e.data,o={headers:Ct(),params:Object(ft["a"])({},s)};return It.get(vt+"/".concat(n,"/").concat(a),o)},Rt=function(t){var e=Dt(t),n=e.cityPath,a=e.data,s={headers:Ct(),params:Object(ft["a"])({},a)};return It.get(bt+"/".concat(n),s)},$t=function(t){var e={headers:Ct(),params:Object(ft["a"])({},t)};return It.get(wt,e)},Tt=function(t){var e={headers:Ct(),params:Object(ft["a"])({},t)};return It.get(kt,e)},Bt=function(t){var e=Dt(t),n=e.cityPath,a=e.data,s={headers:Ct(),params:Object(ft["a"])({},a)};return It.get(gt+"/".concat(n),s)},Et=function(t){var e=Dt(t),n=e.cityPath,a=e.data,s={headers:Ct(),params:Object(ft["a"])({},a)};return It.get(xt+"/".concat(n),s)},zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"\n        flex\n        items-center\n        justify-between\n        flex-wrap\n        h-16\n        border-b\n        px-2\n        cursor-pointer\n        border-line\n    ",on:{click:t.goRouteDetail}},[n("p",{staticClass:"w-24 font-bold",class:{red:t.itemData.EstimateTime<=90},domProps:{innerHTML:t._s(t.transStatus(t.itemData))}}),n("p",{staticClass:"text-black w-3/5"},[n("span",[t.isIndex?t._e():n("strong",[t._v(t._s(t.order)+".")]),t._v(" "+t._s(t.itemData.RouteName.Zh_tw))]),n("span",{staticClass:"text-gray-400 text-sm block w-full"},[t._v(" "+t._s(t.head&&"開往"+t.head||"--")+" ")])]),n("img",{staticClass:"w-6 block",attrs:{src:"images/arrow/arrow-right-light.svg",alt:""}})])},Ut=[],Zt=(n("a9e3"),{props:{itemData:{type:Object,default:function(){}},order:{type:Number,default:0}},computed:Object(ft["a"])(Object(ft["a"])({},Object(pt["b"])(["terminalList"])),{},{target:function(){return this.terminalList[this.itemData.RouteUID]},head:function(){var t,e;return 0===this.itemData.Direction?null===(t=this.target)||void 0===t?void 0:t.DestinationStopNameZh:null===(e=this.target)||void 0===e?void 0:e.DepartureStopNameZh},isIndex:function(){return"/"===this.$route.path}}),methods:{transStatus:function(t){return J(t)},goRouteDetail:function(){var t=this.itemData,e=t.RouteName,n=t.RouteUID,a=this.target,s=a.DepartureStopNameZh,o=a.DestinationStopNameZh,i=a.City;this.$router.push({path:"/busroute",query:{routeUID:n,routeName:e.Zh_tw,city:i,to:s,back:o}})}}}),At=Zt,Ft=(n("516d"),Object(u["a"])(At,zt,Ut,!1,null,"c3db1036",null)),Yt=Ft.exports,Ht={components:{BusNearEstimateItem:Yt},data:function(){return{showList:!1,timer:null,second:60,nearPos:{latitude:"",longitude:""},stopList:[],nearStop:{},timeList:[],initFlag:!1,isPendding:!1}},computed:Object(ft["a"])(Object(ft["a"])({},Object(pt["b"])(["terminalList"])),{},{sortedTimeList:function(){var t=Object(dt["a"])(this.timeList);return t.sort((function(t,e){var n,a,s=null!==(n=t.EstimateTime)&&void 0!==n?n:99999,o=null!==(a=e.EstimateTime)&&void 0!==a?a:99999;return s-o}))}}),methods:{transStatus:function(t){return J(t)},refresh:function(){this.second=60,this.getNearEstimated(),this.getDataByTimer()},getDataByTimer:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.second-=1,t.second<=0&&(t.second=60,t.getNearEstimated())}),1e3)},getNowPos:function(){var t=this;navigator.geolocation&&(this.$bus.$emit("setLoading",!0),navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.longitude,a=e.coords.latitude;console.log(n,a),t.showList=!0,t.getNearStop(a,n),t.setNowPos({latitude:a,longitude:n}),t.$bus.$emit("setLoading",!1)}),(function(e){var n=e.code,a=e.message;console.log("error","code=".concat(n,", msg=").concat(a)),t.$bus.$emit("setLoading",!1)})))},setNowPos:function(t){this.$emit("setNowPos",t)},filterBusList:function(t){var e=[];return t.filter((function(t){if(!e.includes(t.StationID))return e.push(t.StationID),t}))},getNearStop:function(t,e){var n=this;return Object(ut["a"])(regeneratorRuntime.mark((function a(){var s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={$spatialFilter:"nearby(".concat(t,",").concat(e,", 500)")},a.prev=1,a.next=4,$t(s);case 4:o=a.sent,n.stopList=n.filterBusList(o),o.length>0&&n.calcDistance(t,e),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),console.log("error",a.t0);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},calcDistance:function(t,e){if(1!==this.stopList.length){var n=this.stopList.map((function(t){var e,n;return[null===(e=t.StationPosition)||void 0===e?void 0:e.PositionLat,null===(n=t.StationPosition)||void 0===n?void 0:n.PositionLon]})),a=n.map((function(n){var a=Object(lt["a"])(n,2),s=a[0],o=a[1];return q(t,e,s,o)})),s=a.indexOf(Math.min.apply(Math,Object(dt["a"])(a)));this.nearStop=this.stopList[s];var o=this.nearStop.StationPosition,i=o.PositionLat,r=o.PositionLon,c=this.nearStop.StationName;this.nearPos={latitude:i,longitude:r},this.$emit("drawStation",{PositionLat:i,PositionLon:r,StationName:c}),this.getNearEstimated()}else this.nearStop=this.stopList[0]},getNearEstimated:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.nearPos,a=n.latitude,s=n.longitude,o={$spatialFilter:"nearby(".concat(a,",").concat(s,", 30)")},e.prev=2,e.next=5,Tt(o);case 5:i=e.sent,t.timeList=i,t.timeList.length>0&&t.getDataByTimer(),!t.initFlag&&t.getBusInfo(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),console.log("error",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()},getBusInfo:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(dt["a"])(t.timeList),a=regeneratorRuntime.mark((function e(n){var a,s,o,i,r,c,l,u,d,f,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.timeList[n].RouteUID,s=a.substr(0,3),o=jt.find((function(t){return t.ISO===s})),i=o.value,!t.terminalList[a]){e.next=5;break}return e.abrupt("return",{v:void 0});case 5:return r={city:i,$filter:"contains(RouteUID, '".concat(a,"')")},e.prev=6,e.next=9,Ot(r);case 9:c=e.sent,l=c[0],u=l.DepartureStopNameZh,d=l.DestinationStopNameZh,f=l.City,p=l.RouteName,t.$store.commit("updateTerminalList",{RouteName:p.Zh_tw,RouteUID:a,DestinationStopNameZh:d,DepartureStopNameZh:u,City:f}),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](6),console.log("error",e.t0);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})),s=0;case 3:if(!(s<n.length)){e.next=11;break}return e.delegateYield(a(s),"t0",5);case 5:if(o=e.t0,"object"!==Object(ct["a"])(o)){e.next=8;break}return e.abrupt("return",o.v);case 8:s++,e.next=3;break;case 11:t.initFlag=!0;case 12:case"end":return e.stop()}}),e)})))()}},beforeDestroy:function(){clearInterval(this.timer)}},Kt=Ht,Vt=(n("c609"),Object(u["a"])(Kt,it,rt,!1,null,"1d87f260",null)),qt=Vt.exports,Gt={name:"Home",components:{Footer:O,Header:B,NearStop:qt,IndexMenu:F,MapIndex:ot},data:function(){return{}},methods:{goPath:function(t){this.$router.push(t)},setNowPos:function(t){var e=t.latitude,n=t.longitude;this.$refs.mapIndex.setView(e,n),this.$refs.mapIndex.drawSelfMark(e,n)},drawStation:function(t){var e=t.PositionLat,n=t.PositionLon,a=t.StationName;this.$refs.mapIndex.drawStation(e,n,a)}}},Jt=Gt,Wt=Object(u["a"])(Jt,S,L,!1,null,"2c40db28",null),Qt=Wt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header"),n("map-route",{ref:"mapRoute",attrs:{mapInfo:t.mapInfo},on:{initData:t.initData}}),n("div",{staticClass:"panel side-block",style:{transform:"translateY("+this.moveY+"vh)","transition-duration":"0.3s"}},[n("div",{staticClass:"h-8 md:hidden",on:{click:t.ctrlPanel}},[n("div",{staticClass:"w-10 h-0.5 bg-gray-400 m-auto"})]),n("bus-route-info",{attrs:{stopInfo:t.stopInfo,destination:t.destination,city:t.city,routeUID:t.routeUID,routeName:t.routeName},on:{clickStop:t.clickStop}})],1),n("Footer")],1)},te=[],ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"relative"},[n("img",{staticClass:"py-2 cursor-pointer",attrs:{src:"images/arrow/back.svg",alt:""},on:{click:t.goBack}}),n("p",{staticClass:"text-gray-500 text-sm py-2"},[t._v(" 將於"+t._s(t.second)+"秒後更新 "),n("img",{staticClass:"inline cursor-pointer",attrs:{src:"images/Refresh.svg",alt:""},on:{click:t.refresh}})]),n("h1",{staticClass:"text-3xl font-bold pb-4"},[t._v(" "+t._s(t.routeName)+" "),n("font-awesome-icon",{staticClass:"text-gray-400 text-2xl cursor-pointer",class:{"text-status-error":t.isExistFavorite},attrs:{icon:"heart"},on:{click:t.setFavorite}})],1),n("ul",{staticClass:"\n            flex\n            justify-between\n            items-center\n            border-b border-gray-300\n            relative\n            z-30\n        "},[n("li",{class:["tab-item",{active:0===t.listType}],on:{click:function(e){return t.setTab(0)}}},[t._v(" 往"+t._s(t.destination.back)+" ")]),n("li",{class:["tab-item",{active:1===t.listType}],on:{click:function(e){return t.setTab(1)}}},[t._v(" 往"+t._s(t.destination.to)+" ")])]),n("ul",{staticClass:"scroll-list"},t._l(t.typeBusList,(function(e,a){return n("li",{key:e.StopUID,staticClass:"\n                w-full\n                flex\n                items-center\n                border-b\n                py-4\n                cursor-pointer\n                border-line\n                relative\n                hover:bg-gray-200\n            ",on:{click:function(n){return t.clickStop(e)}}},[n("span",{staticClass:"w-24",domProps:{innerHTML:t._s(t.transStatus(e))}}),n("span",[n("strong",[t._v(t._s(a+1)+".")]),t._v(" "+t._s(e.StopName.Zh_tw)+" ")]),n("span",{staticClass:"h-full w-px bg-gray-300 absolute line top-0"}),n("span",{staticClass:"\n                    border\n                    absolute\n                    right-1.5\n                    top-6\n                    border-gray-400\n                    w-3\n                    h-3\n                    rounded-full\n                ",class:e.PlateNumb?"bg-primary-500":"bg-light"}),e.PlateNumb?n("span",{staticClass:"\n                    absolute\n                    right-6\n                    flex\n                    items-center\n                    justify-center\n                    top-5\n                    gradients-deep\n                    text-center text-light text-sm\n                    w-20\n                    h-5\n                    rounded-2xl\n                "},[t._v(t._s(e.PlateNumb))]):t._e()])})),0),n("div",{staticClass:"line"})])},ne=[],ae=(n("159b"),n("c740"),{props:{routeName:{type:String,default:""},city:{type:String,default:""},routeUID:{type:String,default:""},destination:{type:Object,default:function(){}},stopInfo:{type:Array,default:function(){return[]}}},watch:{routeName:{immediate:!0,handler:function(){this.routeName&&(this.getBusArrive(),this.getDataByTimer())}}},computed:Object(ft["a"])(Object(ft["a"])({},Object(pt["b"])(["favoriteList"])),{},{goBus:function(){var t=this.busData.filter((function(t){return 0===t.Direction}));return this.sortData(t,0)},backBus:function(){var t=this.busData.filter((function(t){return 1===t.Direction}));return this.sortData(t,1)},typeBusList:function(){return 0===this.listType?this.goBus:this.backBus},isExistFavorite:function(){var t=this;return this.favoriteList.some((function(e){return e.RouteUID===t.routeUID}))}}),data:function(){return{timer:null,listType:0,second:60,busData:[],busPos:[]}},methods:{transStatus:function(t){return J(t)},refresh:function(){this.second=60,this.getBusArrive(),this.getDataByTimer()},getDataByTimer:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.second-=1,t.second<=0&&(t.second=60,t.getBusArrive())}),1e3)},getBusArrive:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n={city:t.city,$filter:"contains(RouteUID,'".concat(t.routeUID,"')")},t.$bus.$emit("setLoading",!0),e.next=5,Et(n);case 5:a=e.sent,t.$bus.$emit("setLoading",!1),t.busData=a,t.getBusRealInfo(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log("error",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},getBusRealInfo:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n={city:t.city,$filter:"contains(RouteUID,'".concat(t.routeUID,"')")},e.next=4,Bt(n);case 4:a=e.sent,t.combineData(a),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log("error",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},combineData:function(t){var e=this,n=Object(dt["a"])(this.busData);t.forEach((function(t){var a=e.busData.findIndex((function(e){return e.StopUID===t.StopUID}));n[a]["PlateNumb"]=t.PlateNumb})),this.busData=n},setTab:function(t){this.listType=t},goBack:function(){this.$router.go(-1)},clickStop:function(t){this.$emit("clickStop",t)},setFavorite:function(){var t={RouteName:{Zh_tw:this.routeName},City:this.city,RouteUID:this.routeUID,DepartureStopNameZh:this.destination.to,DestinationStopNameZh:this.destination.back};this.$store.commit("updateFavoriteList",t)},sortData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=[];return console.warn("arr",t),console.warn("this.stopInfo~~~",this.stopInfo),this.stopInfo[e]["Stops"].forEach((function(e){var a=t.find((function(t){return t.StopUID===e.StopUID}));n.push(a)})),console.warn("order",e),console.warn("temp",n),n}},mounted:function(){},beforeDestroy:function(){clearInterval(this.timer)}}),se=ae,oe=(n("3a14"),Object(u["a"])(se,ee,ne,!1,null,"e2e8f202",null)),ie=oe.exports,re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.setClass,attrs:{id:"map"}})},ce=[],le=n("1134"),ue=null,de=null,fe=null,pe=null,me=null,he=null,ve={props:{mapInfo:{type:Array,default:function(){return[]}},setClass:{type:String,default:""}},data:function(){return{}},methods:{createMap:function(){var t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";ue=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(ue),de=W().addTo(ue),pe=(new V.a.MarkerClusterGroup).addTo(ue),this.$emit("initData")},cleanMarker:function(){de.clearLayers(),ue.eachLayer((function(t){t instanceof V.a.Marker&&ue.removeLayer(t)}))},cleanBus:function(){pe.clearLayers()},setView:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14;ue.setView([t,e],n)},createMark:function(){me=new V.a.Icon({iconUrl:"images/mark/BusStop-start.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),he=new V.a.Icon({iconUrl:"images/mark/BusStop-end.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawMark:function(t){var e,n,a,s,o=Object(dt["a"])(t),i=o.shift(),r=o.pop();de.addLayer(V.a.marker([null===i||void 0===i||null===(e=i.StopPosition)||void 0===e?void 0:e.PositionLat,null===i||void 0===i||null===(n=i.StopPosition)||void 0===n?void 0:n.PositionLon],{icon:me}).bindPopup(' <h2 class="title">'.concat(i.StopName.Zh_tw,"</h2>"))),de.addLayer(V.a.marker([null===r||void 0===r||null===(a=r.StopPosition)||void 0===a?void 0:a.PositionLat,null===r||void 0===r||null===(s=r.StopPosition)||void 0===s?void 0:s.PositionLon],{icon:he}).bindPopup(' <h2 class="title">'.concat(r.StopName.Zh_tw,"</h2>"))),o.forEach((function(t,e){var n=t.StopPosition,a=n.PositionLat,s=n.PositionLon;de.addLayer(V.a.marker([a,s],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:'\n                            <div class="w-16 h-14 relative flex justify-center items-center">\n                                <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                                <span class="text-light font-bold text-base text-center relative z-10 pb-2.5">'.concat(e+1,"</span>\n                            </div>")})}))})),ue.addLayer(de)},drawBus:function(t){this.cleanBus(),t.forEach((function(t){var e=t.BusPosition,n=e.PositionLat,a=e.PositionLon,s=t.PlateNumb;pe.addLayer(V.a.marker([n,a],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,70],html:'\n                                <div class="w-20 h-12 relative">\n                                <p class="font-bold text-sm text-center text-light gradients-deep relative z-10 p-1 rounded-lg" >\n                                    '.concat(s,'\n                                </p>\n                                <img class="w-12 m-auto" src="images/mark/BusStop.svg"/>\n                            </div>\n')})}))})),ue.addLayer(pe)},drawLine:function(t){var e=new le["Wkt"];e.read(t);var n=e.toJson(),a={color:"#7550cc",weight:3};fe=V.a.geoJSON(n,{style:a}).addTo(ue),fe.addData(n),ue.fitBounds(fe.getBounds()),ue.addLayer(fe)},initMap:function(){this.createMark(),this.createMap()}},mounted:function(){},beforeDestroy:function(){ue=null,de=null,fe=null,pe=null}},be=ve,ge=Object(u["a"])(be,re,ce,!1,null,"d2bb2f8c",null),ye=ge.exports,we={inject:["appData"],components:{BusRouteInfo:ie,MapRoute:ye,Footer:O,Header:B},computed:{isMobile:function(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},watch:{isMobile:{immediate:!0,handler:function(t){t||(this.moveY=0)}}},data:function(){return{moveY:60,routeName:"",routeUID:"",city:"",mapInfo:[],stopInfo:[],destination:{to:"",back:""}}},methods:{getRouteMapMark:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={city:t.city,$filter:"contains(RouteUID,'".concat(t.routeUID,"')"),$select:"Direction, Stops"},e.prev=1,e.next=4,Pt(n);case 4:a=e.sent,t.mapInfo=a[0].Stops,t.stopInfo=a,t.setView(t.mapInfo),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))()},getRouteLine:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={city:t.city,$filter:"contains(RouteUID,'".concat(t.routeUID,"')")},e.prev=1,e.next=4,Mt(n);case 4:a=e.sent,s=a[0].Geometry,t.$refs.mapRoute.drawLine(s),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log("error",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},getBusPos:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={city:t.city,$filter:"contains(RouteUID,'".concat(t.routeUID,"')")},e.prev=1,e.next=4,Rt(n);case 4:a=e.sent,s=a,t.$refs.mapRoute.drawBus(s),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log("error",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},initData:function(){this.getRouteMapMark(),this.getRouteLine(),this.getBusPos()},setView:function(t){var e,n=null===(e=t[0])||void 0===e?void 0:e.StopPosition,a=n.PositionLat,s=n.PositionLon;this.$refs.mapRoute.drawMark(t),this.$refs.mapRoute.setView(a,s,12)},ctrlPanel:function(){this.moveY=60===this.moveY?10:60},clickStop:function(t){console.log("obj====",t);var e=t.StopUID,n=this.mapInfo.find((function(t){return t.StopUID===e})),a=n.StopPosition,s=a.PositionLat,o=a.PositionLon;this.$refs.mapRoute.setView(s,o,18)}},mounted:function(){this.routeName=this.$route.query.routeName,this.routeUID=this.$route.query.routeUID,this.city=this.$route.query.city;var t=this.$route.query.to,e=this.$route.query.back;this.destination={to:t,back:e},this.$refs.mapRoute.initMap()}},xe=we,ke=Object(u["a"])(xe,Xt,te,!1,null,null,null),je=ke.exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header"),n("map-searchs",{ref:"mapSearch",attrs:{setClass:"for-web"}}),n("div",{staticClass:"px-4 pt-10 side-block"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.city,expression:"city"}],staticClass:"mb-2",on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.city=e.target.multiple?n:n[0]},t.getRoute]}},t._l(t.CITY_LIST,(function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),0),n("div",{staticClass:"input-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.routeName,expression:"routeName"}],ref:"inputRouteName",attrs:{type:"text",placeholder:"請輸入公車路線"},domProps:{value:t.routeName},on:{input:[function(e){e.target.composing||(t.routeName=e.target.value)},t.keyIn]}}),t.routeName?n("img",{staticClass:"w-6 cursor-pointer",attrs:{src:"images/close-style2.svg",alt:""},on:{click:t.reset}}):t._e()]),n("bus-search-list",{attrs:{pageData:t.pageData}}),n("transition",{attrs:{name:"slide-fade"}},[t.showKeyboard?n("key-board",{on:{setRouteName:t.setRouteName,reset:t.reset,deleteRouteName:t.deleteRouteName}}):t._e()],1),n("bus-search-btn",{attrs:{showKeyboard:t.showKeyboard},on:{ctrlKeyboard:t.ctrlKeyboard}})],1),n("Footer")],1)},Le=[],_e=(n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",{staticClass:"text-left pt-4 text-gray-500"},[t._v("搜尋結果")]),n("ul",{staticClass:"scroll-list"},[t._l(t.pageData,(function(t){return[n("bus-search-list-item",{key:t.RouteUID,attrs:{item:t}})]})),0===t.pageData.length?n("li",{staticClass:"no-data"},[n("p",[t._v("哎呀!查無結果")]),n("p",[t._v("請重新搜尋關鍵字或切換縣市")])]):t._e()],2)])}),Ie=[],Ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"\n        rounded-md\n        pl-4\n        py-2\n        border-line border-b\n        text-left\n        relative\n        cursor-pointer\n    ",on:{click:function(e){return t.toBusRoute()}}},[n("h3",{staticClass:"font-bold text-black"},[t._v(" "+t._s(t.item.RouteName.Zh_tw)+" ")]),n("p",{staticClass:"text-gray-500 text-sm"},[t._v(" "+t._s(t.item.DepartureStopNameZh)+" "),n("span",[t._v(" - ")]),t._v(" "+t._s(t.item.DestinationStopNameZh)+" ")]),n("img",{staticClass:"w-6 absolute right-2 top-4",attrs:{src:"images/arrow/arrow-right-light.svg",alt:""}})])},Ce=[],De={props:{item:{type:Object,default:function(){}}},methods:{toBusRoute:function(){var t=this.item,e=t.DepartureStopNameZh,n=t.DestinationStopNameZh,a=t.RouteName,s=t.RouteUID,o=t.City;this.$router.push({path:"/busroute",query:{routeUID:s,routeName:a.Zh_tw,city:o,to:e,back:n}})}}},Oe=De,Pe=Object(u["a"])(Oe,Ne,Ce,!1,null,null,null),Me=Pe.exports,Re={components:{BusSearchListItem:Me},props:{pageData:{type:Array,default:function(){return[]}}}},$e=Re,Te=Object(u["a"])($e,_e,Ie,!1,null,null,null),Be=Te.exports,Ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"\n        fixed\n        bottom-0\n        left-0\n        w-full\n        p-2\n        h-56\n        flex\n        justify-between\n        flex-wrap\n        bg-gray-300\n        border-t border-gray-500\n        md:absolute\n    "},[t._l(t.keyBoardList,(function(e){return n("li",{key:e.value,staticClass:"keyboard-item",style:{color:e.style?e.style:"#37206D"},on:{click:function(n){e.fn?t.handleFunction(e.fn):t.setRouteName(e.value)}}},[t._v(" "+t._s(e.value)+" ")])})),n("li",{staticClass:"keyboard-item bg-gray-400",on:{click:t.deleteRouteName}},[n("img",{attrs:{src:"images/Keyboard-delete.svg",alt:""}})])],2)},ze=[],Ue={name:"Home",components:{},props:{keyword:{type:String,default:""}},computed:{keyBoardList:function(){return this.keyBoardShow?this.keyList:this.keyList2}},data:function(){return{keyBoardShow:!0,keyList:[{value:"紅",style:"#FB5B44",fn:""},{value:"藍",style:"#448DFB",fn:""},{value:"1",style:"",fn:""},{value:"2",style:"",fn:""},{value:"3",style:"",fn:""},{value:"綠",style:"#59DD86",fn:""},{value:"棕",style:"#D4A274",fn:""},{value:"4",style:"",fn:""},{value:"5",style:"",fn:""},{value:"6",style:"",fn:""},{value:"橘",style:"#FB9232",fn:""},{value:"黃",style:"#ECC94C",fn:""},{value:"7",style:"",fn:""},{value:"8",style:"",fn:""},{value:"9",style:"",fn:""},{value:"更多",style:"#6F7585",fn:"ctrlKeyboard"},{value:"幹線",style:"",fn:""},{value:"0",style:"",fn:""},{value:"重設",style:"#6F7585",fn:"reset"}],keyList2:[{value:"市民",style:"",fn:""},{value:"捷運",style:"",fn:""},{value:"貓空",style:"",fn:""},{value:"A",style:"",fn:""},{value:"F",style:"",fn:""},{value:"內科",style:"",fn:""},{value:"高鐵",style:"",fn:""},{value:"跳蛙",style:"",fn:""},{value:"L",style:"",fn:""},{value:"R",style:"",fn:""},{value:"南軟",style:"",fn:""},{value:"快線",style:"",fn:""},{value:"JOY",style:"",fn:""},{value:"E",style:"",fn:""},{value:"T",style:"",fn:""},{value:"返回",style:"gray",fn:"ctrlKeyboard"}]}},methods:{setRouteName:function(t){this.$emit("setRouteName",t)},deleteRouteName:function(){this.$emit("deleteRouteName")},reset:function(){this.$emit("reset")},ctrlKeyboard:function(){this.keyBoardShow=!this.keyBoardShow},handleFunction:function(t){this[t]()}}},Ze=Ue,Ae=Object(u["a"])(Ze,Ee,ze,!1,null,"402fa984",null),Fe=Ae.exports,Ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"touch-ball fixed md:absolute right-2 top-32",on:{click:t.ctrlKeyboard}},[t.inView?n("img",{attrs:{src:"images/"+(t.showKeyboard?"keyboard":"command")+".svg",alt:""}}):n("p",{staticClass:"text-gray-500"},[t._v("TOP")])])},He=[],Ke={props:{showKeyboard:{type:Boolean,default:!1}},data:function(){return{inView:!0,scrollContainer:null}},methods:{ctrlKeyboard:function(){this.inView&&this.$emit("ctrlKeyboard"),this.inView||this.scrollContainer.scrollTo({top:0,left:0,behavior:"smooth"})},scrollEvent:function(){this.inView=this.scrollContainer.scrollTop<=this.scrollContainer.offsetHeight}},mounted:function(){this.scrollContainer=document.querySelector(".scroll-list"),this.scrollContainer.addEventListener("scroll",this.scrollEvent)},beforeDestroy:function(){this.scrollContainer.removeEventListener("scroll",this.scrollEvent)}},Ve=Ke,qe=Object(u["a"])(Ve,Ye,He,!1,null,"2703bf07",null),Ge=qe.exports,Je=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.setClass,attrs:{id:"map"}})},We=[],Qe=null,Xe=null,tn=null,en=null,nn=null,an=null,sn=null,on={props:{mapInfo:{type:Array,default:function(){return[]}},setClass:{type:String,default:""}},data:function(){return{}},methods:{createMap:function(){var t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Qe=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(Qe),Xe=W().addTo(Qe),en=(new V.a.MarkerClusterGroup).addTo(Qe),this.setView(25.033876641528444,121.56456344001262)},cleanMarker:function(){Xe.clearLayers(),Qe.eachLayer((function(t){t instanceof V.a.Marker&&Qe.removeLayer(t)}))},cleanBus:function(){en.clearLayers()},setView:function(t,e){Qe.setView([t,e],16)},createMark:function(){nn=new V.a.Icon({iconUrl:"images/mark/bus.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),an=new V.a.Icon({iconUrl:"images/mark/BusStop-start.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),sn=new V.a.Icon({iconUrl:"images/mark/BusStop-end.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawMark:function(t){var e,n,a,s,o=Object(dt["a"])(t),i=o.shift(),r=o.pop();Xe.addLayer(V.a.marker([null===i||void 0===i||null===(e=i.StopPosition)||void 0===e?void 0:e.PositionLat,null===i||void 0===i||null===(n=i.StopPosition)||void 0===n?void 0:n.PositionLon],{icon:an}).bindPopup(' <h2 class="title">'.concat(i.StopName.Zh_tw,"</h2>"))),Xe.addLayer(V.a.marker([null===r||void 0===r||null===(a=r.StopPosition)||void 0===a?void 0:a.PositionLat,null===r||void 0===r||null===(s=r.StopPosition)||void 0===s?void 0:s.PositionLon],{icon:sn}).bindPopup(' <h2 class="title">'.concat(r.StopName.Zh_tw,"</h2>"))),o.forEach((function(t,e){var n=t.StopPosition,a=n.PositionLat,s=n.PositionLon;Xe.addLayer(V.a.marker([a,s],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:'\n                            <div class="w-16 h-14 relative flex justify-center items-center">\n                                <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                                <span class="text-light font-bold text-base text-center relative z-10 pb-2">'.concat(e+1,"</span>\n                            </div>")})}))})),Qe.addLayer(Xe)},drawBus:function(t){this.cleanBus(),t.forEach((function(t){var e=t.BusPosition,n=e.PositionLat,a=e.PositionLon,s=t.PlateNumb;en.addLayer(V.a.marker([n,a],{icon:nn}).bindPopup('\n                            <h2 class="title">'.concat(s,"</h2>\n                        ")))})),Qe.addLayer(en)},drawLine:function(t){var e=new le["Wkt"];e.read(t);var n=e.toJson(),a={color:"#7550cc",weight:3};tn=V.a.geoJSON(n,{style:a}).addTo(Qe),tn.addData(n),Qe.fitBounds(tn.getBounds()),Qe.addLayer(tn)}},mounted:function(){this.createMark(),this.createMap()},beforeDestroy:function(){Qe=null,Xe=null,tn=null,en=null}},rn=on,cn=Object(u["a"])(rn,Je,We,!1,null,"3e81a2ee",null),ln=cn.exports,un={components:{KeyBoard:Fe,BusSearchList:Be,BusSearchBtn:Ge,MapSearchs:ln,Footer:O,Header:B},data:function(){return{CITY_LIST:jt,city:jt[0].value,routeName:"",busList:[],showKeyboard:!1,pageData:[],endFlag:!1}},computed:{liveBus:function(){return this.busList.filter((function(t){return t.PlateNumb}))},showSearch:function(){return this.routeName.length>0}},methods:{getRoute:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={city:t.city,$filter:t.routeName?"contains(RouteName/Zh_tw, '".concat(t.routeName,"')"):""},e.prev=1,e.next=4,Ot(n);case 4:a=e.sent,t.busList=a,t.pageData=[],t.splitData(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log("error",e.t0);case 13:t.setView();case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()},splitData:function(){0===this.busList.length&&(this.endFlag=!0);var t=this.busList.splice(0,30);this.pageData=this.pageData.concat(t)},setRouteName:function(t){this.routeName+=t,this.getRoute()},deleteRouteName:function(){this.routeName=this.routeName.substring(0,this.routeName.length-1),this.routeName||this.getRoute()},keyIn:function(t){this.routeName=t.target.value,this.getRoute()},reset:function(){this.routeName="",this.getRoute()},ctrlKeyboard:function(){this.showKeyboard=!this.showKeyboard,this.showKeyboard||this.$refs.inputRouteName.focus()},scrollEvent:function(){if(!this.endFlag){var t=document.querySelector(".scroll-list");t.scrollTop===t.scrollHeight-t.offsetHeight&&this.splitData()}},setView:function(){var t=this,e=jt.find((function(e){return e.value===t.city})),n=e.pos,a=n.lat,s=n.lon;this.$refs.mapSearch.setView(a,s)}},mounted:function(){this.getRoute();var t=document.querySelector(".scroll-list");t.addEventListener("scroll",this.scrollEvent)},beforeDestroy:function(){var t=document.querySelector(".scroll-list");t.removeEventListener("scroll",this.scrollEvent)}},dn=un,fn=(n("723c"),Object(u["a"])(dn,Se,Le,!1,null,null,null)),pn=fn.exports,mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header"),n("map-searchs",{ref:"mapSearch",attrs:{setClass:"for-web"}}),n("div",{staticClass:"side-block pt-10 px-4"},[n("h2",{staticClass:"py-4 text-gray-500 text-left"},[t._v("我的最愛")]),n("ul",{staticClass:"scroll-list"},[t._l(t.favoriteList,(function(t){return[n("bus-search-list-item",{key:t.RouteUID,attrs:{item:t}})]}))],2)]),n("Footer")],1)},hn=[],vn={components:{BusSearchListItem:Me,MapSearchs:ln,Footer:O,Header:B},computed:Object(ft["a"])({},Object(pt["b"])(["favoriteList"]))},bn=vn,gn=Object(u["a"])(bn,mn,hn,!1,null,null,null),yn=gn.exports,wn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header"),n("map-near",{ref:"mapNear",on:{setStop:t.setStop,getNowPos:t.getNowPos}}),n("div",{staticClass:"touch-ball z-50 right-0 top-72 md:left-0 md:top-48",on:{click:t.focusSelf}},[n("img",{attrs:{src:"images/cursor.svg",alt:""}})]),n("div",{staticClass:"panel side-block",style:{transform:"translateY("+this.moveY+"vh)","transition-duration":"0.3s"}},[n("div",{staticClass:"h-10 md:hidden",on:{click:t.ctrlPanel}},[n("div",{staticClass:"w-10 h-0.5 bg-gray-400 m-auto"})]),t.showNearStation?n("bus-near-list",{attrs:{stopList:t.stopList,direction:t.direction},on:{selectStop:t.selectStop}}):n("bus-near-estimate",{attrs:{direction:t.direction,stopInfo:t.stopInfo},on:{goBack:t.goBack}})],1),n("Footer")],1)},xn=[],kn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"md:px-4"},[n("h2",{staticClass:"py-4 text-gray-400 text-left"},[t._v("最近站牌")]),n("ul",{staticClass:"relative scroll-list z-30 w-full"},[t._l(t.stopList,(function(e,a){return n("li",{key:e.StationUID,staticClass:"\n                p-2\n                my-2\n                border border-purple-300\n                cursor-pointer\n                rounded-lg\n                text-left\n            ",on:{click:function(n){return t.selectStop(e)}}},[n("h3",{staticClass:"font-bold text-black py-2"},[n("span",[t._v(t._s(a+1))]),t._v(" "+t._s(e.StationName.Zh_tw)+" "),n("span",{staticClass:"\n                        rounded-full\n                        bg-gray-400\n                        px-2\n                        py-1\n                        text-sm text-white\n                    "},[t._v(" "+t._s(t.direction[e.Bearing])+" ")])]),n("p",{staticClass:"text-primary-700"},[t._v(" "+t._s(t.transRoute(e.Stops))+" ")])])})),0===t.stopList.length?n("li",{staticClass:"no-data"},[t._v("附近找不到站牌")]):t._e()],2)])},jn=[],Sn=(n("a15b"),{props:{stopList:{type:Array,default:function(){return[]}},direction:{type:Object,default:function(){}}},data:function(){return{}},methods:{selectStop:function(t){this.$emit("selectStop",t)},transRoute:function(t){var e=t.map((function(t){return t.RouteName.Zh_tw}));return e.join(",")}}}),Ln=Sn,_n=(n("c0ec"),Object(u["a"])(Ln,kn,jn,!1,null,"09ac6e5a",null)),In=_n.exports,Nn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"map"}})},Cn=[],Dn=null,On=null,Pn=null,Mn=null,Rn={data:function(){return{}},methods:{createMap:function(){var t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Dn=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(Dn);var e=W();On=(new V.a.MarkerClusterGroup).addTo(Dn),Pn=e.addTo(Dn),this.$emit("getNowPos")},cleanMarker:function(){On.clearLayers(),Dn.eachLayer((function(t){t instanceof V.a.Marker&&Dn.removeLayer(t)}))},cleanStation:function(){Pn.clearLayers()},setView:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;Dn.setView([t,e],n)},createMark:function(){Mn=new V.a.Icon({iconUrl:"images/mark/TrackingSpot.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawSelfMark:function(t,e){On.addLayer(V.a.marker([t,e],{icon:Mn})),Dn.addLayer(On),this.setView(t,e)},drawStation:function(t){var e=this;this.cleanStation(),t.forEach((function(t,n){var a=t.StationPosition,s=a.PositionLat,o=a.PositionLon,i=new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:'\n                    <div class="w-16 h-14 relative flex justify-center items-center">\n                        <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                        <span class="text-light font-bold text-base text-center relative z-10 pb-4">'.concat(n+1,"</span>\n                    </div>\n                    ")});Pn.addLayer(V.a.marker([s,o],{icon:i}).on("click",e.markerOnClick))})),Dn.addLayer(Pn)},markerOnClick:function(t){var e=t.latlng,n=e.lat,a=e.lng;this.$emit("setStop",{lat:n,lng:a})}},mounted:function(){this.createMark(),this.createMap()},beforeDestroy:function(){Dn=null,On=null,Pn=null}},$n=Rn,Tn=Object(u["a"])($n,Nn,Cn,!1,null,"4f8d6a4b",null),Bn=Tn.exports,En=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{staticClass:"py-2 cursor-pointer",attrs:{src:"images/arrow/back.svg",alt:""},on:{click:t.goBack}}),n("h3",{staticClass:"font-bold text-black py-2"},[t._v(" "+t._s(t.stopInfo&&t.stopInfo.StationName.Zh_tw)+" "),n("span",{staticClass:"rounded-full bg-gray-400 px-2 py-1 text-sm text-white"},[t._v(" "+t._s(t.stopInfo&&t.direction[t.stopInfo.Bearing])+" ")])]),n("ul",{staticClass:"scroll-list"},[t._l(t.timeList,(function(t,e){return[n("bus-near-estimate-item",{key:t.RouteUID,attrs:{order:e+1,itemData:t}})]}))],2),n("div",{staticClass:"line"})])},zn=[],Un={components:{BusNearEstimateItem:Yt},props:{stopInfo:{type:Object,default:function(){}},direction:{type:Object,default:function(){}}},computed:Object(ft["a"])({},Object(pt["b"])(["terminalList"])),watch:{stopInfo:function(){this.stopInfo&&(this.getNearEstimated(),this.getDataByTimer())}},data:function(){return{timer:null,listType:0,second:60,timeList:[],initFlag:!1}},methods:{goBack:function(){this.$emit("goBack")},getDataByTimer:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.second-=1,t.second<=0&&(t.second=60,t.getNearEstimated())}),1e3)},getNearEstimated:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.stopInfo.StationPosition,a=n.PositionLat,s=n.PositionLon,t.$bus.$emit("setLoading",!0),o={$spatialFilter:"nearby(".concat(a,",").concat(s,", 30)")},e.prev=3,e.next=6,Tt(o);case 6:i=e.sent,t.timeList=i,t.timeList.length>0&&t.getDataByTimer(),!t.initFlag&&t.getBusInfo(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),console.log("error",e.t0);case 15:t.$bus.$emit("setLoading",!1);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})))()},getBusInfo:function(){var t=this;return Object(ut["a"])(regeneratorRuntime.mark((function e(){var n,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(dt["a"])(t.timeList),a=regeneratorRuntime.mark((function e(n){var a,s,o,i,r,c,l,u,d,f,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.timeList[n].RouteUID,s=a.substr(0,3),o=jt.find((function(t){return t.ISO===s})),i=o.value,!t.terminalList[a]){e.next=5;break}return e.abrupt("return",{v:void 0});case 5:return r={city:i,$filter:"contains(RouteUID,\n                            '".concat(a,"')")},e.prev=6,e.next=9,Ot(r);case 9:c=e.sent,l=c[0],u=l.DepartureStopNameZh,d=l.DestinationStopNameZh,f=l.City,p=l.RouteName,t.$store.commit("updateTerminalList",{RouteName:p.Zh_tw,RouteUID:a,DestinationStopNameZh:d,DepartureStopNameZh:u,City:f}),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](6),console.log("error",e.t0);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})),s=0;case 3:if(!(s<n.length)){e.next=11;break}return e.delegateYield(a(s),"t0",5);case 5:if(o=e.t0,"object"!==Object(ct["a"])(o)){e.next=8;break}return e.abrupt("return",o.v);case 8:s++,e.next=3;break;case 11:t.initFlag=!0;case 12:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.getNearEstimated(),this.getDataByTimer()},beforeDestroy:function(){clearInterval(this.timer)}},Zn=Un,An=Object(u["a"])(Zn,En,zn,!1,null,null,null),Fn=An.exports,Yn={inject:["appData"],components:{BusNearList:In,MapNear:Bn,BusNearEstimate:Fn,Footer:O,Header:B},data:function(){return{moveY:60,stopList:[],timeList:[],routeList:[],stopInfo:{},showNearStation:!0,selfPos:{},direction:{E:"東行",W:"西行",S:"南行",N:"北行",SE:"東南行",NE:"東北行",SW:"西南行",NW:"西北行"}}},computed:{stationIDList:function(){return this.stopList.map((function(t){return t.StationID}))},isMobile:function(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},watch:{isMobile:{immediate:!0,handler:function(t){t||(this.moveY=0)}}},methods:{getNowPos:function(){var t=this;navigator.geolocation&&(this.$bus.$emit("setLoading",!0),navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.longitude,a=e.coords.latitude;t.selfPos={latitude:a,longitude:n},t.getNearStop(a,n),t.$refs.mapNear.drawSelfMark(a,n),t.$bus.$emit("setLoading",!1)}),(function(e){var n=e.code,a=e.message;t.getNearStop(25.047675,121.517055),t.$bus.$emit("setLoading",!1),console.log("error","code=".concat(n,",\n                            msg=").concat(a))})))},focusSelf:function(){var t=this.selfPos,e=t.latitude,n=t.longitude;this.$refs.mapNear.setView(e,n)},getNearStop:function(t,e){var n=this;return Object(ut["a"])(regeneratorRuntime.mark((function a(){var s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={$spatialFilter:"nearby(".concat(t,",").concat(e,", 500)")},a.prev=1,a.next=4,$t(s);case 4:o=a.sent,n.stopList=n.filterReapeatList(o),n.$refs.mapNear.drawStation(n.stopList),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),console.log("error",a.t0);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},filterReapeatList:function(t){var e=[];return t.filter((function(t){if(!e.includes(t.StationID))return e.push(t.StationID),t}))},selectStop:function(t){var e=t.StationPosition,n=e.PositionLat,a=e.PositionLon;this.stopInfo=t,this.showNearStation=!1,this.$refs.mapNear.setView(n,a,18)},ctrlPanel:function(){this.moveY=60===this.moveY?10:60},goBack:function(){this.showNearStation=!0,this.focusSelf()},setStop:function(t){var e=t.lat,n=t.lng,a=this.stopList.find((function(t){var a=t.StationPosition,s=a.PositionLat,o=a.PositionLon;return s===e&&o===n}));this.stopInfo=a,this.showNearStation=!1,this.$refs.mapNear.setView(e,n,18)}}},Hn=Yn,Kn=Object(u["a"])(Hn,wn,xn,!1,null,null,null),Vn=Kn.exports;a["a"].use(j["a"]);var qn=[{path:"/",name:"Index",component:Qt},{path:"/busroute",name:"BusRoute",component:je},{path:"/bussearch",name:"BusSearch",component:pn},{path:"/favorite",name:"Favorite",component:yn},{path:"/busnear",name:"BusNear",component:Vn}],Gn=new j["a"]({routes:qn}),Jn=Gn,Wn=n("bfa9");a["a"].use(pt["a"]);var Qn=new Wn["a"]({storage:window.localStorage,reducer:function(t){return{favoriteList:t.favoriteList,terminalList:t.terminalList}}}),Xn=function(){return{favoriteList:[],terminalList:[]}},ta=new pt["a"].Store({state:Xn,mutations:{updateFavoriteList:function(t,e){var n=e.RouteUID,a=t.favoriteList.findIndex((function(t){return t.RouteUID===n}));a>=0?t.favoriteList.splice(a,1):t.favoriteList.push(e)},updateTerminalList:function(t,e){var n=e.RouteUID,s=e.RouteName,o=e.DestinationStopNameZh,i=e.DepartureStopNameZh,r=e.City;a["a"].set(t.terminalList,n,{RouteName:s,DestinationStopNameZh:o,DepartureStopNameZh:i,City:r})}},actions:{},modules:{},plugins:[Qn.plugin]}),ea=n("a584"),na=(n("96b1"),n("b972"),n("6cc5"),n("8243"),n("3ac1"),n("7319"),n("b9eb")),aa=n.n(na),sa=n("ecee"),oa=n("c074"),ia=n("ad3d");a["a"].component("font-awesome-icon",ia["a"]),a["a"].component("pagination",aa.a),sa["c"].add(oa["a"]),a["a"].config.productionTip=!1,a["a"].use(ea["a"],{config:{id:"G-N2LJBT6101"}}),a["a"].prototype.$bus=new a["a"],new a["a"]({router:Jn,store:ta,render:function(t){return t(k)}}).$mount("#app")},"640b":function(t,e,n){},"723c":function(t,e,n){"use strict";n("640b")},"85ec":function(t,e,n){},"8e53":function(t,e,n){},"96b1":function(t,e,n){},"98c4":function(t,e,n){},a420:function(t,e,n){},a7d3:function(t,e,n){},adf7:function(t,e,n){},c0ec:function(t,e,n){"use strict";n("8e53")},c609:function(t,e,n){"use strict";n("4127")},cf19:function(t,e,n){"use strict";n("d7c9")},d7c9:function(t,e,n){},dbf2:function(t,e,n){},de35:function(t,e,n){"use strict";n("dbf2")},e6cd:function(t,e,n){},fc16:function(t,e,n){"use strict";n("a420")}});