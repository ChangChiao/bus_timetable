(function(e){function t(t){for(var a,u,i=t[0],s=t[1],c=t[2],p=0,f=[];p<i.length;p++)u=i[p],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&f.push(r[u][0]),r[u]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var s=n[i];0!==r[s]&&(a=!1)}a&&(o.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},r={app:0},o=[];function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("font-awesome-icon",{attrs:{icon:"user-secret"}}),n("router-view"),e.showLoading?n("Loading"):e._e()],1)},o=[],u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loading-wrap"},[n("svg",{staticClass:"spinner",attrs:{width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{staticClass:"path",attrs:{fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"}})])])},i=[],s={},c=s,l=(n("cf19"),n("2877")),p=Object(l["a"])(c,u,i,!1,null,"ef0ba8b8",null),f=p.exports,m={components:{Loading:f},data:function(){return{showLoading:!1}},created:function(){var e=this;this.$bus.$on("setLoading",(function(t){e.showLoading=t}))},beforeDestroy:function(){this.$bus.$off("setLoading")}},d=m,v=(n("034f"),Object(l["a"])(d,r,o,!1,null,null,null)),h=v.exports,b=n("8c4f"),y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[e._v(" 123 "),n("router-link",{attrs:{to:"/busRoute"}},[e._v("/busRoute")]),n("router-link",{attrs:{to:"/busSearch"}},[e._v("/busSearch")]),n("router-link",{attrs:{to:"/favorite"}},[e._v("/favorite")]),n("router-link",{attrs:{to:"/busNear"}},[e._v("/busNear")]),n("router-link",{attrs:{to:"/busmap"}},[e._v("/busmap")])],1)},g=[],w={name:"Home",components:{}},_=w,k=Object(l["a"])(_,y,g,!1,null,null,null),x=k.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ul",[n("li",{on:{click:function(t){return e.setTab(0)}}},[e._v("往{{}}")]),n("li",{on:{click:function(t){return e.setTab(1)}}},[e._v("往{{}}")])]),n("p",[e._v("於"+e._s(e.second)+"秒前更新")]),n("BusRouteInfo",{attrs:{busInfo:0===e.listType?e.goBus:e.backBus}})],1)},N=[],T=n("1da1"),O=(n("96cf"),n("4de4"),n("d3b7"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[e._l(e.liveBusList,(function(t){return n("ul",{key:t.StopUID},[n("li",{staticClass:"w-full border p-2"},[n("span",[e._v(e._s(t.StopName.Zh_tw))]),n("span",[e._v(e._s(e.transStatus(t.EstimateTime)))]),n("span",[e._v("{{}}")])])])})),n("div",{staticClass:"line"})],2)}),C=[],M={props:{busInfo:{type:Array,default:function(){}}},computed:{liveBusList:function(){return this.busInfo.filter((function(e){return e.EstimateTime}))}},data:function(){return{}},methods:{transStatus:function(e){var t=this.transMinute(e),n="";switch(!0){case 0===t:n="進站中";break;case t<=1&&0<t:n="即將到站";break;case!t:n="--";break;default:n=t+"分鐘";break}return n},transMinute:function(e){return Math.floor(e/60)}}},I=M,j=Object(l["a"])(I,O,C,!1,null,null,null),S=j.exports,B=n("5530"),$=(n("99af"),n("bc3a")),D=n.n($),R=D.a.create();R.interceptors.request.use((function(e){return e}),(function(e){return e})),R.interceptors.response.use((function(e){return e.data}),(function(e){return Promise.reject(e)}));var P=R,E="https://ptx.transportdata.tw/MOTC/v2/Bus",A=E+"/Route/City",K=E+"/EstimatedTimeOfArrival/City",Y=E+"/StopOfRoute/City",H=[{label:"臺北市",value:"Taipei"},{label:"新北市",value:"NewTaipei"},{label:"桃園市",value:"Taoyuan"},{label:"臺中市",value:"Taichung"},{label:"臺南市",value:"Tainan"},{label:"高雄市",value:"Kaohsiung"},{label:"基隆市",value:"Keelung"},{label:"新竹市",value:"Hsinchu"},{label:"新竹縣",value:"HsinchuCounty"},{label:"苗栗縣",value:"MiaoliCounty"},{label:"彰化縣",value:"ChanghuaCounty"},{label:"南投縣",value:"NantouCounty"},{label:"雲林縣",value:"YunlinCounty"},{label:"嘉義縣",value:"ChiayiCounty"},{label:"嘉義市",value:"Chiayi"},{label:"屏東縣",value:"PingtungCounty"},{label:"宜蘭縣",value:"YilanCounty"},{label:"花蓮縣",value:"HualienCounty"},{label:"臺東縣",value:"TaitungCounty"},{label:"金門縣",value:"KinmenCounty"},{label:"澎湖縣",value:"PenghuCounty"},{label:"連江縣",value:"LienchiangCounty"}],Z=n("6c2d"),z=function(){var e="b65665fcca144956a79d25bb3edc7b34",t="daVxLDO01nPgTTwhQKVBmY-pjeQ",n=(new Date).toGMTString(),a=new Z["a"]("SHA-1","TEXT");a.setHMACKey(t,"TEXT"),a.update("x-date: "+n);var r=a.getHMAC("B64"),o='hmac username="'.concat(e,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(r,'"');return{Authorization:o,"X-Date":n,"Content-Type":"application/x-www-form-urlencoded"}},V=function(e){console.log("data",e);var t=e.city,n=e.routeName;return delete e.city,delete e.routeName,{cityPath:t,routeName:n,data:e}},J=function(e){var t=V(e),n=t.cityPath,a=t.routeName,r=t.data,o={headers:z(),params:Object(B["a"])({},r)};return console.log("routeName",a),P.get(A+"/".concat(n,"/").concat(a),o)},G=function(e){var t=V(e),n=t.cityPath,a=t.routeName,r=t.data,o={headers:z(),params:Object(B["a"])({},r)};return P.get(K+"/".concat(n,"/").concat(a),o)},U=function(e){var t=V(e),n=t.cityPath,a=t.routeName,r=t.data,o={headers:z(),params:Object(B["a"])({},r)};return P.get(Y+"/".concat(n,"/").concat(a),o)},Q={components:{BusRouteInfo:S},data:function(){return{CITY_LIST:H,timer:null,routeName:"225",city:H[0].value,busData:[],listType:0,second:60}},computed:{goBus:function(){return this.busData.filter((function(e){return 0===e.Direction}))},backBus:function(){return this.busData.filter((function(e){return 1===e.Direction}))}},methods:{getDataByTimer:function(){var e=this;this.timer=setInterval((function(){e.second-=1,e.second<=0&&(e.second=60,e.getBusArrive())}),1e3)},getBusArrive:function(){var e=this;return Object(T["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n={city:e.city,routeName:e.routeName},e.$bus.$emit("setLoading",!0),t.next=5,G(n);case 5:a=t.sent,e.$bus.$emit("setLoading",!1),e.busData=a,console.log("result"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log("error",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},setTab:function(e){this.listType=e}},mounted:function(){this.getBusArrive(),this.getDataByTimer()},beforeDestroy:function(){clearInterval(this.timer)}},X=Q,F=Object(l["a"])(X,L,N,!1,null,null,null),W=F.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("select",{directives:[{name:"model",rawName:"v-model",value:e.city,expression:"city"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.city=t.target.multiple?n:n[0]},e.getRoute]}},e._l(e.CITY_LIST,(function(t){return n("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),0),n("h2",[e._v(e._s(e.routeName))]),n("KeyBoard",{on:{setrouteName:e.setrouteName,reset:e.reset,deleterouteName:e.deleterouteName}}),n("ul",[e._l(e.busList,(function(e){return[n("BusListItem",{key:e.RouteUID,attrs:{itemData:e}})]}))],2)],1)},ee=[],te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"border rounded-md p-2"},[n("h3",[e._v(e._s(e.itemData.RouteName.Zh_tw))]),n("p",[e._v(" "+e._s(e.itemData.DepartureStopNameZh)+" "),n("span"),e._v(" "+e._s(e.itemData.DestinationStopNameZh)+" ")])])},ne=[],ae={props:{itemData:{type:Object,default:function(){}}},methods:{toBusInfo:function(){this.$router.push("/")}}},re=ae,oe=Object(l["a"])(re,te,ne,!1,null,null,null),ue=oe.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"flex flex-wrap"},[e._l(e.keyList,(function(t){return n("li",{key:t,staticClass:"\n            w-1/5\n            border\n            flex\n            justify-center\n            items-center\n            rounded-md\n            h-10\n            cursor-pointer\n        ",on:{click:function(n){return e.setKeyword(t)}}},[e._v(" "+e._s(t)+" ")])})),n("li",{on:{click:e.deleteKeyword}},[n("i",[e._v("delete")])]),n("li",{on:{click:e.reset}},[n("i",[e._v("reset")])])],2)},se=[],ce={name:"Home",components:{},props:{keyword:{type:String,default:""}},data:function(){return{keyList:["紅","藍","1","2","3","綠","棕","4","5","6","橘","小","7","8","9"]}},methods:{setKeyword:function(e){this.$emit("setKeyword",e)},deleteKeyword:function(){this.$emit("deleteKeyword")},reset:function(){this.$emit("reset")}}},le=ce,pe=Object(l["a"])(le,ie,se,!1,null,null,null),fe=pe.exports,me={components:{KeyBoard:fe,BusListItem:ue},data:function(){return{CITY_LIST:H,routeName:"",city:H[0].value,busList:[]}},computed:{liveBus:function(){return this.busList.filter((function(e){return e.PlateNumb}))}},methods:{getRoute:function(){var e=this;return Object(T["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={city:e.city,routeName:e.routeName},t.prev=1,t.next=4,J(n);case 4:a=t.sent,e.busList=a,console.log("result",a),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},setrouteName:function(e){this.routeName+=e,this.getRoute()},deleterouteName:function(){this.routeName=this.routeName.substring(0,this.routeName-1)},reset:function(){this.routeName=""}},mounted:function(){this.getRoute()}},de=me,ve=Object(l["a"])(de,q,ee,!1,null,null,null),he=ve.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[e._l(e.favoriteList,(function(e){return[n("BusListItem",{key:e})]}))],2)},ye=[],ge=n("2f62"),we={components:{BusListItem:ue},computed:Object(B["a"])({},Object(ge["b"])(["favoriteList"]))},_e=we,ke=Object(l["a"])(_e,be,ye,!1,null,null,null),xe=ke.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},Ne=[],Te={},Oe=Te,Ce=Object(l["a"])(Oe,Le,Ne,!1,null,null,null),Me=Ce.exports,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Map",{ref:"map",attrs:{mapInfo:e.mapInfo},on:{getRouteMap:e.getRouteMap}})},je=[],Se=(n("d81d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-screen h-screen",attrs:{id:"map"}})}),Be=[],$e=(n("159b"),n("6cc5"),n("e11e")),De=n.n($e),Re=n("1134"),Pe=(n("8243"),n("3ac1"),n("7319"),null),Ee=null,Ae=null,Ke=null,Ye={props:{mapInfo:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{createMap:function(){var e="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Pe=De.a.map("map"),De.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:e}).addTo(Pe),console.log("init!!!!"),Ee=(new De.a.MarkerClusterGroup).addTo(Pe),this.$emit("getRouteMap")},cleanMarker:function(){Ee.clearLayers(),Pe.eachLayer((function(e){e instanceof De.a.Marker&&Pe.removeLayer(e)}))},setView:function(e,t){console.log("latitude, longitude",e,t),Pe.setView([e,t],16)},createMark:function(){Ke=new De.a.Icon({iconUrl:"./images/mark.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawMark:function(){this.mapInfo.forEach((function(e){var t=e.StopPosition,n=t.PositionLat,a=t.PositionLon,r=e.StopName;Ee.addLayer(De.a.marker([n,a],{icon:Ke}).bindPopup(' <h2 class="title">'.concat(r.Zh_tw,"</h2>")))})),Pe.addLayer(Ee)},drawLine:function(e){console.log("Geometry",e),this.cleanMarker();var t=new Re["Wkt"],n=t.toJson(),a={color:"#C50047",weight:5};Ae=De.a.geoJSON(n,{style:a}).addTo(Pe),Ae.addData(n),Pe.fitBounds(Ae.getBounds()),Pe.addLayer(Ae)}},mounted:function(){this.createMark(),this.createMap()},beforeDestroy:function(){Pe=null,Ee=null,Ae=null}},He=Ye,Ze=Object(l["a"])(He,Se,Be,!1,null,null,null),ze=Ze.exports,Ve={components:{Map:ze},data:function(){return{routeName:"225",city:"Taipei",mapInfo:[]}},methods:{getRouteMap:function(){var e=this;return Object(T["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={routeName:e.routeName,city:e.city},t.prev=1,t.next=4,U(n);case 4:a=t.sent,console.log("result",a),e.mapInfo=a[0].Stops,console.log("this.mapInfo",e.mapInfo),e.setView(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log("error",t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))()},setView:function(){var e,t=null===(e=this.mapInfo[0])||void 0===e?void 0:e.StopPosition,n=t.PositionLat,a=t.PositionLon;this.$refs.map.setView(n,a),this.$refs.map.drawMark()}},mounted:function(){}},Je=Ve,Ge=Object(l["a"])(Je,Ie,je,!1,null,null,null),Ue=Ge.exports;a["a"].use(b["a"]);var Qe=[{path:"/",name:"Index",component:x},{path:"/busRoute",name:"BusRoute",component:W},{path:"/busSearch",name:"BusSearch",component:he},{path:"/favorite",name:"Favorite",component:xe},{path:"/busNear",name:"BusNear",component:Me},{path:"/busmap",name:"BusMap",component:Ue}],Xe=new b["a"]({routes:Qe}),Fe=Xe,We=n("bfa9");a["a"].use(ge["a"]);var qe=new We["a"]({storage:window.localStorage,reducer:function(e){return{favoriteList:e.favoriteList}}}),et=function(){return{favoriteList:[]}},tt=new ge["a"].Store({state:et,mutations:{updateFavoriteList:function(e,t){e.favoriteList=t}},actions:{},modules:{},plugins:[qe.plugin]}),nt=(n("b972"),n("b9eb")),at=n.n(nt),rt=n("ecee"),ot=n("c074"),ut=n("ad3d");a["a"].component("font-awesome-icon",ut["a"]),a["a"].component("pagination",at.a),rt["c"].add(ot["c"]),rt["c"].add(ot["a"]),rt["c"].add(ot["b"]),a["a"].config.productionTip=!1,a["a"].prototype.$bus=new a["a"],new a["a"]({router:Fe,store:tt,render:function(e){return e(h)}}).$mount("#app")},"85ec":function(e,t,n){},cf19:function(e,t,n){"use strict";n("d7c9")},d7c9:function(e,t,n){}});