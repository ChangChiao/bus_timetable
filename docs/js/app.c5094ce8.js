(function(t){function e(e){for(var a,n,r=e[0],l=e[1],c=e[2],d=0,h=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&h.push(o[n][0]),o[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],a=!0,r=1;r<s.length;r++){var l=s[r];0!==o[l]&&(a=!1)}a&&(i.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},o={app:0},i=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;i.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"26b5":function(t,e,s){"use strict";s("7c80")},"343e":function(t,e,s){},3696:function(t,e,s){},"3aed":function(t,e,s){"use strict";s("703f")},"3e8c":function(t,e,s){},4551:function(t,e,s){"use strict";s("3e8c")},4678:function(t,e,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function o(t){var e=i(t);return s(e)}function i(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}o.keys=function(){return Object.keys(a)},o.resolve=i,t.exports=o,o.id="4678"},"4da5":function(t,e,s){"use strict";s("d5f7")},"50d7":function(t,e,s){"use strict";s("d2f6")},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view"),t.showMobileMenu?e("mobile-menu"):t._e(),t.showLoading?e("Loading"):t._e()],1)},i=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading-wrap"},[e("svg",{staticClass:"spinner",attrs:{width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{staticClass:"path",attrs:{fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"}})])])},r=[],l={},c=l,u=(s("4551"),s("2877")),d=Object(u["a"])(c,n,r,!1,null,"ef0ba8b8",null),h=d.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-screen overflow-hidden md:hidden"},[t.active?e("div",{staticClass:"fixed w-screen h-screen top-0 left-0 z-50"},[e("div",{staticClass:"mask"}),e("nav",{staticClass:"menu overflow-hidden fixed right-0 top-0 w-60 gradients-dark z-30"},[e("ul",{staticClass:"menu-list absolute pt-16 pr-48 top-16 rounded-full gradients"},t._l(t.menuList,(function(s){return e("li",{key:s.path,staticClass:"text-white pr-40 py-4 text-right text-lg",on:{click:function(e){return t.goPath(s.path)}}},[t._v(" "+t._s(s.name)+" ")])})),0)])]):t._e(),t.showHam?e("div",{class:["mobile-menu-btn",{active:t.active}],on:{click:t.ctrlMenu}},[t._m(0),e("img",{staticClass:"absolute h-8 w-8 top-12 left-0",attrs:{src:`images/header/HeadMenu-quarter-${t.active?"W":"P"}_mobile.svg`,alt:""}})]):t._e()])},m=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"hamburger"},[e("span",{staticClass:"line"}),e("span",{staticClass:"line"}),e("span",{staticClass:"line"})])}],f=(s("14d9"),{data(){return{menuList:[{name:"回首頁",path:"/"},{name:"公車快找",path:"/bussearch"},{name:"查詢公車",path:"/busnear"},{name:"我的最愛",path:"/favorite"}],active:!1,showHam:!0}},methods:{ctrlMenu(){this.active=!this.active},goPath(t){this.$router.push(t),this.active=!1}},mounted(){this.showHam="/"!==this.$route.path}}),b=f,v=(s("b29f"),Object(u["a"])(b,p,m,!1,null,"620e757a",null)),g=v.exports,y={components:{Loading:h,MobileMenu:g},watch:{$route:{immediate:!0,handler:function(t){this.showMobileMenu="/"!==t.path}}},data(){return{showLoading:!1,showMobileMenu:!1,windowSize:0}},created(){this.$bus.$on("setLoading",t=>{this.showLoading=t})},methods:{resizeEvent(){this.windowSize=window.innerWidth}},mounted(){this.windowSize=window.innerWidth,window.addEventListener("resize",this.resizeEvent)},beforeDestroy(){this.$bus.$off("setLoading"),window.removeEventListener("resize",this.resizeEvent)},provide(){const t={};return Object.defineProperty(t,"windowSize",{get:()=>this.windowSize}),{appData:t}}},w=y,S=(s("4da5"),Object(u["a"])(w,o,i,!1,null,null,null)),x=S.exports,k=s("8c4f"),j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("Header"),e("div",{staticClass:"px-4"},[e("index-menu")],1),e("map-index",{ref:"mapIndex"}),e("near-stop",{on:{setNowPos:t.setNowPos,drawStation:t.drawStation}}),e("Footer")],1)},L=[],_=function(){var t=this,e=t._self._c;return!t.isMobile||t.isMobile&&t.isIndex?e("footer",{staticClass:"bg-primary-700 h-9 fixed bottom-0 flex justify-center items-center text-white z-50 md:right-0"},[t._v(" The F2E 3rd Week3 - Bus ")]):t._e()},I=[],N={inject:["appData"],computed:{isMobile(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},data(){return{isIndex:!1}},mounted(){"/"===this.$route.path&&(this.isIndex=!0)}},C=N,D=(s("d6f1"),Object(u["a"])(C,_,I,!1,null,null,null)),P=D.exports,$=function(){var t=this,e=t._self._c;return!t.isMobile||t.isMobile&&t.isIndex?e("header",{staticClass:"gradients-deep flex flex-wrap justify-center items-center relative h-24 w-full text-white md:h-20 md:justify-between",class:t.setClass},[t._m(0),e("ul",{staticClass:"hidden md:flex md:justify-end justify-center items-center pr-12 w-2/5"},t._l(t.menuList,(function(s){return e("li",{key:s.path,staticClass:"text-white cursor-pointer text-lg md:mr-3 hover:text-purple-200",on:{click:function(e){return t.goPath(s.path)}}},[t._v(" "+t._s(s.name)+" ")])})),0),e("img",{staticClass:"absolute top-1 left-1 md:h-16 md:left-3",attrs:{src:"images/Index-header-logo.svg",alt:""},on:{click:function(e){return t.goPath("/")}}}),e("img",{staticClass:"absolute bottom-0 right-0",attrs:{src:"images/Index-header-quarter.svg",alt:""}})]):t._e()},M=[function(){var t=this,e=t._self._c;return e("h1",{staticClass:"w-full text-2xl text-left pl-24 md:w-2/5"},[t._v(" 機智公車族 "),e("p",{staticClass:"text-base"},[t._v("全台公車動態時刻查詢應用服務")])])}],T={inject:["appData"],props:{setClass:{type:String,default:""}},data(){return{menuList:[{name:"公車快找",path:"/bussearch"},{name:"查詢公車",path:"/busnear"},{name:"我的最愛",path:"/favorite"}],showHeader:!1,isIndex:!1}},computed:{isMobile(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},methods:{goPath(t){this.$router.push(t)}},mounted(){"/"===this.$route.path&&(this.isIndex=!0)}},O=T,B=(s("50d7"),Object(u["a"])(O,$,M,!1,null,null,null)),R=B.exports,z=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"mt-8 md:fixed md:w-96 md:right-0 top-32 z-50 md:cursor-pointer"},[e("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/bussearch")}}},[t._m(0),e("img",{attrs:{src:"images/Index-section-image04_m.svg",alt:""}})]),e("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/busnear")}}},[t._m(1),e("img",{attrs:{src:"images/Index-section-image01_m.svg",alt:""}})]),e("li",{staticClass:"list-item",on:{click:function(e){return t.goPath("/favorite")}}},[t._m(2),e("img",{attrs:{src:"images/Index-section-image02_m.svg",alt:""}})])])},U=[function(){var t=this,e=t._self._c;return e("p",{staticClass:"w-2/3 text-left"},[e("span",{staticClass:"text-lg font-bold block text-black"},[t._v("公車快找")]),e("span",{staticClass:"text-gray-600 text-sm"},[t._v("直接輸入路線名稱獲得資訊！")])])},function(){var t=this,e=t._self._c;return e("p",{staticClass:"w-2/3 text-left"},[e("span",{staticClass:"text-lg font-bold block text-black"},[t._v("查詢站牌")]),e("span",{staticClass:"text-gray-600 text-sm"},[t._v("附近站牌 / 公車動態及路線圖")])])},function(){var t=this,e=t._self._c;return e("p",{staticClass:"w-2/3 text-left"},[e("span",{staticClass:"text-lg font-bold block text-black"},[t._v("我的最愛")]),e("span",{staticClass:"text-gray-600 text-sm"},[t._v("將常用路線加入我的最愛吧！")])])}],E={methods:{goPath(t){this.$router.push(t)}}},Z=E,A=(s("90e7"),Object(u["a"])(Z,z,U,!1,null,"1e5c2f5c",null)),F=A.exports,Y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"for-web",attrs:{id:"map"}})},H=[],K=(s("c1df"),s("e11e")),V=s.n(K);const q=(t,e="success")=>{t&&console.log("msg",t,e)},G=(t,e,s,a,o="K")=>{if(t==s&&e==a)return 0;{let i=Math.PI*t/180,n=Math.PI*s/180,r=e-a,l=Math.PI*r/180,c=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(l);return c>1&&(c=1),c=Math.acos(c),c=180*c/Math.PI,c=60*c*1.1515,"K"==o&&(c*=1.609344),"N"==o&&(c*=.8684),c}},J=t=>Math.floor(t/60),W=t=>{const{EstimateTime:e,StopStatus:s}=t,a=J(e),o={1:"尚未發車",2:"交管不停靠",3:"末班車已過",4:"今日未營運"};if(0!==s)return`<span class='bg-gray-500 text-white text-sm p-2 mr-2 rounded-md'>${o[s]}</span>`;let i="";switch(!0){case 0===a:i="<span class='red'>進站中</span>";break;case a<=1&&0<a:i="<span class='red'>即將到站</span>";break;default:i=`<span class="font-bold text-lg px-2">${a}</span><span class="font-normal">分</span>`;break}return i},Q=()=>new V.a.markerClusterGroup({showCoverageOnHover:!1,spiderfyOnMaxZoom:!0,zoomToBoundsOnClick:!0,argumentsspiderfyOnMaxZoom:!1,maxClusterRadius:120,iconCreateFunction:function(t){const e=t.getAllChildMarkers();let s=" marker-cluster-";s+=e<10?"small":e<100?"medium":"large";const a=`\n                    <div class="group">\n                        <span>\n                            ${e.length}\n                        </span>\n                    </div>\n                    `;return new V.a.DivIcon({html:a,className:"marker-cluster"+s,iconSize:new V.a.Point(40,40)})}});let X=null,tt=null,et=null,st=null;var at={data(){return{}},methods:{createMap(){let t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";X=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(X);let e=Q();tt=(new V.a.MarkerClusterGroup).addTo(X),et=e.addTo(X),this.setView(25.033876641528444,121.56456344001262)},cleanMarker(){tt.clearLayers(),X.eachLayer(t=>{t instanceof V.a.Marker&&X.removeLayer(t)})},cleanStation(){et.clearLayers()},setView(t,e,s=16){X.setView([t,e],s)},createMark(){st=new V.a.Icon({iconUrl:"images/mark/TrackingSpot.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawSelfMark(t,e){tt.addLayer(V.a.marker([t,e],{icon:st})),X.addLayer(tt),this.setView(t,e)},drawStation(t,e,s){this.cleanStation(),et.addLayer(V.a.marker([t,e],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:`\n                        <div class="w-24 h-14 relative">\n                            <p class="text-light font-bold text-sm text-center relative z-10 p-2 bg-primary-700 rounded-lg m-auto">\n                                ${s.Zh_tw}\n                            </p>\n                            <img class="w-9 m-auto" src="images/mark/BusStop.svg"/>\n                        </div>`})}).on("click",this.markerOnClick)),X.addLayer(et)}},mounted(){this.createMark(),this.createMap()},beforeDestroy(){X=null,tt=null,et=null}},ot=at,it=Object(u["a"])(ot,Y,H,!1,null,"6ac9f12d",null),nt=it.exports,rt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"near-stop side-block"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showList,expression:"!showList"}],staticClass:"pos-btn px-4 md:py-4"},[e("p",{staticClass:"text-center text-md font-bold block text-black pt-6"},[t._v(" 開啟裝置定位功能，以便為您提供更好的服務。 ")]),e("p",{staticClass:"text-center text-sm text-primary-700 pb-2"},[t._v(" 我們將用在提供您所在位置附近的交通等資訊。 ")]),e("button",{staticClass:"border-2 w-full h-12 text-primary-500 border-primary-500 rounded-3xl",on:{click:t.getNowPos}},[t._v(" 開啟定位功能 ")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"near-list bg-light mt-8 py-4 px-4 pb-16 min-h"},[e("p",{staticClass:"text-sm text-left py-2 font-bold text-gray-500"},[t._v(" 最近站牌 ")]),e("div",{staticClass:"flex items-center justify-between"},[e("p",{staticClass:"font-bold text-lg"},[t._v(" "+t._s(t.nearStop.StationName&&t.nearStop.StationName.Zh_tw)+" ")]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.timeList.length>0,expression:"timeList.length > 0"}],staticClass:"text-sm text-left font-bold text-gray-500"},[t._v("將於"+t._s(t.second)+"秒後更新 "),e("img",{staticClass:"inline cursor-pointer",attrs:{src:"images/Refresh.svg",alt:""},on:{click:t.refresh}})])]),e("ul",{staticClass:"stop-list overflow-y-scroll"},[t._l(t.sortedTimeList,(function(t){return[e("bus-near-estimate-item",{key:t.StopUID,attrs:{itemData:t}})]})),e("li",{directives:[{name:"show",rawName:"v-show",value:0===t.sortedTimeList.length,expression:"sortedTimeList.length === 0"}],staticClass:"no-data"},[t._v(" 附近無站牌 ")])],2)])])},lt=[],ct=s("2f62");const ut="https://tdx.transportdata.tw/api/basic/v2/Bus",dt="https://tdx.transportdata.tw/api/advanced/v2/Bus",ht="https://tdx.transportdata.tw/auth/realms/TDXConnect/protocol/openid-connect/token",pt=ut+"/Route/City",mt=ut+"/Shape/City",ft=ut+"/RealTimeByFrequency/City",bt=ut+"/RealTimeNearStop/City",vt=ut+"/StopOfRoute/City",gt=dt+"/Station/NearBy",yt=ut+"/EstimatedTimeOfArrival/City",wt=dt+"/EstimatedTimeOfArrival/NearBy",St=[{ISO:"TPE",label:"臺北市",value:"Taipei",pos:{lat:25.03387664152844,lon:121.56456344001262}},{ISO:"NWT",label:"新北市",value:"NewTaipei",pos:{lat:25.014174781858774,lon:121.4643227956334}},{ISO:"TAO",label:"桃園市",value:"Taoyuan",pos:{lat:24.989124198332156,lon:121.31437562494263}},{ISO:"TXG",label:"臺中市",value:"Taichung",pos:{lat:24.140781058069635,lon:120.68812172254115}},{ISO:"TNN",label:"臺南市",value:"Tainan",pos:{lat:"",lon:""}},{ISO:"KHH",label:"高雄市",value:"Kaohsiung",pos:{lat:22.639670623239073,lon:120.3025722690854}},{ISO:"KEE",label:"基隆市",value:"Keelung",pos:{lat:25.133215692889234,lon:121.73933982864644}},{ISO:"HSZ",label:"新竹市",value:"Hsinchu",pos:{lat:24.801743512239355,lon:120.97163121329774}},{ISO:"HSQ",label:"新竹縣",value:"HsinchuCounty",pos:{lat:24.827112878570077,lon:121.01288224028333}},{ISO:"MIA",label:"苗栗縣",value:"MiaoliCounty",pos:{lat:24.565011108542414,lon:120.82076045562239}},{ISO:"CHA",label:"彰化縣",value:"ChanghuaCounty",pos:{lat:24.081710829901592,lon:120.5385152286296}},{ISO:"NAN",label:"南投縣",value:"NantouCounty",pos:{lat:23.830413252257117,lon:120.78477508413482}},{ISO:"YUN",label:"雲林縣",value:"YunlinCounty",pos:{lat:"",lon:""}},{ISO:"CYQ",label:"嘉義縣",value:"ChiayiCounty",pos:{lat:"",lon:""}},{ISO:"CYI",label:"嘉義市",value:"Chiayi",pos:{lat:23.54424978420921,lon:120.43208978444218}},{ISO:"PIF",label:"屏東縣",value:"PingtungCounty",pos:{lat:23.47933335484157,lon:120.4411223114263}},{ISO:"ILA",label:"宜蘭縣",value:"YilanCounty",pos:{lat:24.754605871450718,lon:121.75814781144638}},{ISO:"HUA",label:"花蓮縣",value:"HualienCounty",pos:{lat:24.039062872284244,lon:121.59699137334108}},{ISO:"TTT",label:"臺東縣",value:"TaitungCounty",pos:{lat:22.79389716809124,lon:121.12339618813223}},{ISO:"KIN",label:"金門縣",value:"KinmenCounty",pos:{lat:24.448677292829426,lon:118.32266374397871}},{ISO:"PEN",label:"澎湖縣",value:"PenghuCounty",pos:{lat:23.571795417402495,lon:119.57745233271699}},{ISO:"LIE",label:"連江縣",value:"LienchiangCounty",pos:{lat:26.15799750356264,lon:119.95197324215599}}];var xt=s("bc3a"),kt=s.n(xt),jt=s("ad06");const Lt=kt.a.create({});Object(jt["a"])(Lt,{retries:3,retryCondition:t=>t.response.status>=400,retryDelay:()=>500});const _t=()=>{const t=localStorage.getItem("token");return{authorization:"Bearer "+t,"Content-Type":"application/x-www-form-urlencoded"}};Lt.interceptors.request.use(t=>{var e;let s=null!==(e=t.params)&&void 0!==e?e:t.data;return t.headers=_t(),Object.keys(s).map(t=>{s[t]||delete s[t]}),t},t=>t),Lt.interceptors.response.use(t=>(console.log("response--interceptors",t),t.status?t.data:t),async t=>{var e;const s=null===t||void 0===t||null===(e=t.response)||void 0===e?void 0:e.status;if(q("error--"+s,"error"),console.log("status",typeof s),403===s||429===s||401===s){const t=await zt();console.log("res",t),t.access_token&&localStorage.setItem("token",t.access_token)}return Promise.reject(t)});var It=Lt;let Nt=0;const Ct=t=>{const{city:e="",routeName:s=""}=t;return delete t.city,delete t.routeName,{cityPath:e,routeName:s,data:t}},Dt=t=>{const{cityPath:e,routeName:s="",data:a}=Ct(t);let o={params:{...a}};return It.get(pt+`/${e}${s}`,o)},Pt=t=>{const{cityPath:e,routeName:s="",data:a}=Ct(t);let o={params:{...a}};return It.get(vt+`/${e}${s}`,o)},$t=t=>{const{cityPath:e,routeName:s,data:a}=Ct(t);let o={params:{...a}};return It.get(mt+`/${e}${s}`,o)},Mt=t=>{const{cityPath:e,data:s}=Ct(t);let a={params:{...s}};return It.get(ft+"/"+e,a)},Tt=t=>{console.log("getStopNear");let e={params:{...t}};return It.get(gt,e)},Ot=t=>{let e={params:{...t}};return It.get(wt,e)},Bt=t=>{const{cityPath:e,data:s}=Ct(t);let a={params:{...s}};return It.get(bt+"/"+e,a)},Rt=t=>{const{cityPath:e,data:s}=Ct(t);let a={params:{...s}};return It.get(yt+"/"+e,a)},zt=()=>{if(Date.now()-Nt<3e3)return Promise.reject("fail");Nt=Date.now();const t={grant_type:"client_credentials",client_id:"t7552175-83b00a85-f388-4d75",client_secret:"40b1e2e1-e589-493c-891a-a0eca36c75b5"};let e={headers:{"Content-Type":"application/x-www-form-urlencoded"}};return It.post(ht,new URLSearchParams(t),e)};var Ut=function(){var t=this,e=t._self._c;return e("li",{staticClass:"flex flex-wrap items-center justify-between h-16 px-2 border-b cursor-pointer border-line",on:{click:t.goRouteDetail}},[e("p",{staticClass:"w-24 font-bold",class:{red:t.itemData.EstimateTime<=90},domProps:{innerHTML:t._s(t.transStatus(t.itemData))}}),e("p",{staticClass:"w-3/5 text-black"},[e("span",[t.isIndex?t._e():e("strong",[t._v(t._s(t.order)+".")]),t._v(" "+t._s(t.itemData.RouteName.Zh_tw))]),e("span",{staticClass:"block w-full text-sm text-gray-400"},[t._v(" "+t._s(t.head&&"開往"+t.head||"--")+" ")])]),e("img",{staticClass:"block w-6",attrs:{src:"images/arrow/arrow-right-light.svg",alt:""}})])},Et=[],Zt={props:{itemData:{type:Object,default:()=>{}},order:{type:Number,default:0}},computed:{...Object(ct["b"])(["terminalList"]),target(){return this.terminalList[this.itemData.RouteUID]},head(){var t,e;return 0===this.itemData.Direction?null===(t=this.target)||void 0===t?void 0:t.DestinationStopNameZh:null===(e=this.target)||void 0===e?void 0:e.DepartureStopNameZh},isIndex(){return"/"===this.$route.path}},methods:{transStatus(t){return W(t)},goRouteDetail(){const{RouteName:t,RouteUID:e}=this.itemData,{DepartureStopNameZh:s,DestinationStopNameZh:a,City:o}=this.target;this.$router.push({path:"/busroute",query:{routeUID:e,routeName:t.Zh_tw,city:o,to:s,back:a}})}}},At=Zt,Ft=(s("5789"),Object(u["a"])(At,Ut,Et,!1,null,"a0cd1cfe",null)),Yt=Ft.exports,Ht={components:{BusNearEstimateItem:Yt},data(){return{showList:!1,timer:null,second:60,nearPos:{latitude:"",longitude:""},stopList:[],nearStop:{},timeList:[],initFlag:!1,isPendding:!1}},computed:{...Object(ct["b"])(["terminalList"]),sortedTimeList(){const t=[...this.timeList];return t.sort((t,e)=>{var s,a;const o=null!==(s=t.EstimateTime)&&void 0!==s?s:99999,i=null!==(a=e.EstimateTime)&&void 0!==a?a:99999;return o-i})}},methods:{transStatus(t){return W(t)},refresh(){this.second=60,this.getNearEstimated(),this.getDataByTimer()},getDataByTimer(){clearInterval(this.timer),this.timer=setInterval(()=>{this.second-=1,this.second<=0&&(this.second=60,this.getNearEstimated())},1e3)},getNowPos(){navigator.geolocation&&(this.$bus.$emit("setLoading",!0),navigator.geolocation.getCurrentPosition(t=>{const e=t.coords.longitude,s=t.coords.latitude;console.log(e,s),this.showList=!0,this.getNearStop(s,e),this.setNowPos({latitude:s,longitude:e}),this.$bus.$emit("setLoading",!1)},t=>{const{code:e,message:s}=t;console.log("error",`code=${e}, msg=${s}`),this.$bus.$emit("setLoading",!1)}))},setNowPos(t){this.$emit("setNowPos",t)},filterBusList(t){const e=[];return t.filter(t=>{if(!e.includes(t.StationID))return e.push(t.StationID),t})},async getNearStop(t,e){const s={$spatialFilter:`nearby(${t},${e}, 500)`};try{const a=await Tt(s);this.stopList=this.filterBusList(a),a.length>0&&this.calcDistance(t,e)}catch(a){console.log("error",a)}},calcDistance(t,e){if(1===this.stopList.length)return void(this.nearStop=this.stopList[0]);const s=this.stopList.map(t=>{var e,s;return[null===(e=t.StationPosition)||void 0===e?void 0:e.PositionLat,null===(s=t.StationPosition)||void 0===s?void 0:s.PositionLon]}),a=s.map(s=>{const[a,o]=s;return G(t,e,a,o)}),o=a.indexOf(Math.min(...a));this.nearStop=this.stopList[o];const{PositionLat:i,PositionLon:n}=this.nearStop.StationPosition,{StationName:r}=this.nearStop;this.nearPos={latitude:i,longitude:n},this.$emit("drawStation",{PositionLat:i,PositionLon:n,StationName:r}),this.getNearEstimated()},async getNearEstimated(){const{latitude:t,longitude:e}=this.nearPos,s={$spatialFilter:`nearby(${t},${e}, 30)`};try{const t=await Ot(s);this.timeList=t,this.timeList.length>0&&this.getDataByTimer(),!this.initFlag&&this.getBusInfo()}catch(a){console.log("error",a)}},async getBusInfo(){let t=[...this.timeList];for(let s=0;s<t.length;s++){const{RouteUID:t}=this.timeList[s],a=t.substr(0,3),{value:o}=St.find(t=>t.ISO===a);if(this.terminalList[t])return;const i={city:o,$filter:`contains(RouteUID, '${t}')`};try{const e=await Dt(i),{DepartureStopNameZh:s,DestinationStopNameZh:a,City:o,RouteName:n}=e[0];this.$store.commit("updateTerminalList",{RouteName:n.Zh_tw,RouteUID:t,DestinationStopNameZh:a,DepartureStopNameZh:s,City:o})}catch(e){console.log("error",e)}}this.initFlag=!0}},beforeDestroy(){clearInterval(this.timer)}},Kt=Ht,Vt=(s("9f31"),Object(u["a"])(Kt,rt,lt,!1,null,"e08be3b4",null)),qt=Vt.exports,Gt={name:"Home",components:{Footer:P,Header:R,NearStop:qt,IndexMenu:F,MapIndex:nt},data(){return{}},methods:{goPath(t){this.$router.push(t)},setNowPos(t){const{latitude:e,longitude:s}=t;this.$refs.mapIndex.setView(e,s),this.$refs.mapIndex.drawSelfMark(e,s)},drawStation(t){const{PositionLat:e,PositionLon:s,StationName:a}=t;this.$refs.mapIndex.drawStation(e,s,a)}}},Jt=Gt,Wt=Object(u["a"])(Jt,j,L,!1,null,"2c40db28",null),Qt=Wt.exports,Xt=function(){var t=this,e=t._self._c;return e("div",[e("Header"),e("map-route",{ref:"mapRoute",attrs:{mapInfo:t.mapInfo},on:{initData:t.initData}}),e("div",{staticClass:"panel side-block",style:{transform:"translateY("+this.moveY+"vh)","transition-duration":"0.3s"}},[e("div",{staticClass:"h-8 md:hidden",on:{click:t.ctrlPanel}},[e("div",{staticClass:"w-10 h-0.5 bg-gray-400 m-auto"})]),e("bus-route-info",{attrs:{stopInfo:t.stopInfo,destination:t.destination,city:t.city,routeUID:t.routeUID,routeName:t.routeName},on:{clickStop:t.clickStop}})],1),e("Footer")],1)},te=[],ee=function(){var t=this,e=t._self._c;return e("div",{staticClass:"relative"},[e("img",{staticClass:"py-2 cursor-pointer",attrs:{src:"images/arrow/back.svg",alt:""},on:{click:t.goBack}}),e("p",{staticClass:"py-2 text-sm text-gray-500"},[t._v(" 將於"+t._s(t.second)+"秒後更新 "),e("img",{staticClass:"inline cursor-pointer",attrs:{src:"images/Refresh.svg",alt:""},on:{click:t.refresh}})]),e("h1",{staticClass:"pb-4 text-3xl font-bold"},[t._v(" "+t._s(t.routeName)+" "),e("font-awesome-icon",{staticClass:"text-2xl text-gray-400 cursor-pointer",class:{"text-status-error":t.isExistFavorite},attrs:{icon:"heart"},on:{click:t.setFavorite}})],1),e("ul",{staticClass:"relative z-30 flex items-center justify-between border-b border-gray-300"},[e("li",{class:["tab-item",{active:0===t.listType}],on:{click:function(e){return t.setTab(0)}}},[t._v(" 往"+t._s(t.destination.back)+" ")]),e("li",{class:["tab-item",{active:1===t.listType}],on:{click:function(e){return t.setTab(1)}}},[t._v(" 往"+t._s(t.destination.to)+" ")])]),e("ul",{staticClass:"scroll-list"},t._l(t.typeBusList,(function(s,a){return e("li",{key:s.StopUID,staticClass:"relative flex items-center w-full py-4 border-b cursor-pointer border-line hover:bg-gray-200",on:{click:function(e){return t.clickStop(s)}}},[e("span",{staticClass:"w-24",domProps:{innerHTML:t._s(t.transStatus(s))}}),e("span",[e("strong",[t._v(t._s(a+1)+".")]),t._v(" "+t._s(s.StopName.Zh_tw)+" ")]),e("span",{staticClass:"absolute top-0 w-px h-full bg-gray-300 line"}),e("span",{staticClass:"border absolute right-1.5 top-6 border-gray-400 w-3 h-3 rounded-full",class:s.PlateNumb?"bg-primary-500":"bg-light"}),s.PlateNumb?e("span",{staticClass:"absolute flex items-center justify-center w-20 h-5 text-sm text-center right-6 top-5 gradients-deep text-light rounded-2xl"},[t._v(t._s(s.PlateNumb))]):t._e()])})),0),e("div",{staticClass:"line"})])},se=[],ae={props:{routeName:{type:String,default:""},city:{type:String,default:""},routeUID:{type:String,default:""},destination:{type:Object,default:()=>{}},stopInfo:{type:Array,default:()=>[]}},watch:{routeName:{immediate:!0,handler(){this.routeName&&(this.getBusArrive(),this.getDataByTimer())}}},computed:{...Object(ct["b"])(["favoriteList"]),goBus(){const t=this.busData.filter(t=>0===t.Direction);return this.sortData(t,0)},backBus(){const t=this.busData.filter(t=>1===t.Direction);return this.sortData(t,1)},typeBusList(){return 0===this.listType?this.goBus:this.backBus},isExistFavorite(){return this.favoriteList.some(t=>t.RouteUID===this.routeUID)}},data(){return{timer:null,listType:0,second:60,busData:[],busPos:[]}},methods:{transStatus(t){return W(t)},refresh(){this.second=60,this.getBusArrive(),this.getDataByTimer()},getDataByTimer(){clearInterval(this.timer),this.timer=setInterval(()=>{this.second-=1,this.second<=0&&(this.second=60,this.getBusArrive())},1e3)},async getBusArrive(){try{const t={city:this.city,$filter:`contains(RouteUID,'${this.routeUID}')`};this.$bus.$emit("setLoading",!0);const e=await Rt(t);this.$bus.$emit("setLoading",!1),this.busData=e,this.getBusRealInfo()}catch(t){console.log("error",t)}},async getBusRealInfo(){try{const t={city:this.city,$filter:`contains(RouteUID,'${this.routeUID}')`},e=await Bt(t);this.combineData(e)}catch(t){console.log("error",t)}},combineData(t){let e=[...this.busData];t.forEach(t=>{console.log("combineData");const s=this.busData.findIndex(e=>e.StopUID===t.StopUID);e[s]["PlateNumb"]=t.PlateNumb}),this.busData=e},setTab(t){this.listType=t},goBack(){this.$router.go(-1)},clickStop(t){this.$emit("clickStop",t)},setFavorite(){const t={RouteName:{Zh_tw:this.routeName},City:this.city,RouteUID:this.routeUID,DepartureStopNameZh:this.destination.to,DestinationStopNameZh:this.destination.back};this.$store.commit("updateFavoriteList",t)},sortData(t=[],e){var s,a;let o=[];return console.warn("arr",t),console.warn("this.stopInfo~~~",this.stopInfo),null===(s=this.stopInfo)||void 0===s||null===(a=s[e])||void 0===a||a["Stops"].forEach(e=>{if(t.length>0){const s=t.find(t=>(null===t||void 0===t?void 0:t.StopUID)===(null===e||void 0===e?void 0:e.StopUID));o.push(s)}}),o}},mounted(){},beforeDestroy(){clearInterval(this.timer)}},oe=ae,ie=(s("3aed"),Object(u["a"])(oe,ee,se,!1,null,"604f42a8",null)),ne=ie.exports,re=function(){var t=this,e=t._self._c;return e("div",{class:t.setClass,attrs:{id:"map"}})},le=[],ce=s("1134");let ue=null,de=null,he=null,pe=null,me=null,fe=null;var be={props:{mapInfo:{type:Array,default:()=>[]},setClass:{type:String,default:""}},data(){return{}},methods:{createMap(){let t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";ue=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(ue),de=Q().addTo(ue),pe=(new V.a.MarkerClusterGroup).addTo(ue),this.$emit("initData")},cleanMarker(){de.clearLayers(),ue.eachLayer(t=>{t instanceof V.a.Marker&&ue.removeLayer(t)})},cleanBus(){pe.clearLayers()},setView(t,e,s=14){ue.setView([t,e],s)},createMark(){me=new V.a.Icon({iconUrl:"images/mark/BusStop-start.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),fe=new V.a.Icon({iconUrl:"images/mark/BusStop-end.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawMark(t){var e,s,a,o;const i=[...t];let n=i.shift(),r=i.pop();de.addLayer(V.a.marker([null===n||void 0===n||null===(e=n.StopPosition)||void 0===e?void 0:e.PositionLat,null===n||void 0===n||null===(s=n.StopPosition)||void 0===s?void 0:s.PositionLon],{icon:me}).bindPopup(` <h2 class="title">${n.StopName.Zh_tw}</h2>`)),de.addLayer(V.a.marker([null===r||void 0===r||null===(a=r.StopPosition)||void 0===a?void 0:a.PositionLat,null===r||void 0===r||null===(o=r.StopPosition)||void 0===o?void 0:o.PositionLon],{icon:fe}).bindPopup(` <h2 class="title">${r.StopName.Zh_tw}</h2>`)),i.forEach((t,e)=>{let{PositionLat:s,PositionLon:a}=t.StopPosition;de.addLayer(V.a.marker([s,a],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:`\n                            <div class="w-16 h-14 relative flex justify-center items-center">\n                                <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                                <span class="text-light font-bold text-base text-center relative z-10 pb-2.5">${e+1}</span>\n                            </div>`})}))}),ue.addLayer(de)},drawBus(t){this.cleanBus(),t.forEach(t=>{let{PositionLat:e,PositionLon:s}=t.BusPosition,{PlateNumb:a}=t;pe.addLayer(V.a.marker([e,s],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,70],html:`\n                                <div class="w-20 h-12 relative">\n                                <p class="font-bold text-sm text-center text-light gradients-deep relative z-10 p-1 rounded-lg" >\n                                    ${a}\n                                </p>\n                                <img class="w-12 m-auto" src="images/mark/BusStop.svg"/>\n                            </div>\n`})}))}),ue.addLayer(pe)},drawLine(t){const e=new ce["Wkt"];e.read(t);const s=e.toJson(),a={color:"#7550cc",weight:3};he=V.a.geoJSON(s,{style:a}).addTo(ue),he.addData(s),ue.fitBounds(he.getBounds()),ue.addLayer(he)},initMap(){this.createMark(),this.createMap()}},mounted(){},beforeDestroy(){ue=null,de=null,he=null,pe=null}},ve=be,ge=Object(u["a"])(ve,re,le,!1,null,"d2bb2f8c",null),ye=ge.exports,we={inject:["appData"],components:{BusRouteInfo:ne,MapRoute:ye,Footer:P,Header:R},computed:{isMobile(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},watch:{isMobile:{immediate:!0,handler(t){t||(this.moveY=0)}}},data(){return{moveY:60,routeName:"",routeUID:"",city:"",mapInfo:[],stopInfo:[],destination:{to:"",back:""}}},methods:{async getRouteMapMark(){const t={city:this.city,$filter:`contains(RouteUID,'${this.routeUID}')`,$select:"Direction, Stops"};try{const e=await Pt(t);this.mapInfo=e[0].Stops,this.stopInfo=e,this.setView(this.mapInfo)}catch(e){console.log("error",e)}},async getRouteLine(){const t={city:this.city,$filter:`contains(RouteUID,'${this.routeUID}')`};try{const e=await $t(t);let s=e[0].Geometry;this.$refs.mapRoute.drawLine(s)}catch(e){console.log("error",e)}},async getBusPos(){const t={city:this.city,$filter:`contains(RouteUID,'${this.routeUID}')`};try{const e=await Mt(t);let s=e;this.$refs.mapRoute.drawBus(s)}catch(e){console.log("error",e)}},initData(){this.getRouteMapMark(),this.getRouteLine(),this.getBusPos()},setView(t){var e;const{PositionLat:s,PositionLon:a}=null===t||void 0===t||null===(e=t[0])||void 0===e?void 0:e.StopPosition;this.$refs.mapRoute.drawMark(t),this.$refs.mapRoute.setView(s,a,12)},ctrlPanel(){this.moveY=60===this.moveY?10:60},clickStop(t){console.log("obj====",t);const{StopUID:e}=t,s=this.mapInfo.find(t=>t.StopUID===e),{PositionLat:a,PositionLon:o}=null===s||void 0===s?void 0:s.StopPosition;this.$refs.mapRoute.setView(a,o,18)}},mounted(){this.routeName=this.$route.query.routeName,this.routeUID=this.$route.query.routeUID,this.city=this.$route.query.city;let t=this.$route.query.to,e=this.$route.query.back;this.destination={to:t,back:e},this.$refs.mapRoute.initMap()}},Se=we,xe=Object(u["a"])(Se,Xt,te,!1,null,null,null),ke=xe.exports,je=function(){var t=this,e=t._self._c;return e("div",[e("Header"),e("map-searchs",{ref:"mapSearch",attrs:{setClass:"for-web"}}),e("div",{staticClass:"px-4 pt-10 side-block"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.city,expression:"city"}],staticClass:"mb-2",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.city=e.target.multiple?s:s[0]},t.getRoute]}},t._l(t.CITY_LIST,(function(s){return e("option",{key:s.value,domProps:{value:s.value}},[t._v(" "+t._s(s.label)+" ")])})),0),e("div",{staticClass:"input-box"},[e("input",{ref:"inputRouteName",attrs:{type:"text",placeholder:"請輸入公車路線"},domProps:{value:t.routeName},on:{input:t.keyIn}}),t.routeName?e("img",{staticClass:"w-6 cursor-pointer",attrs:{src:"images/close-style2.svg",alt:""},on:{click:t.reset}}):t._e()]),e("bus-search-list",{attrs:{pageData:t.pageData}}),e("transition",{attrs:{name:"slide-fade"}},[t.showKeyboard?e("key-board",{on:{setRouteName:t.setRouteName,reset:t.reset,deleteRouteName:t.deleteRouteName}}):t._e()],1),e("bus-search-btn",{attrs:{showKeyboard:t.showKeyboard},on:{ctrlKeyboard:t.ctrlKeyboard}})],1),e("Footer")],1)},Le=[],_e=function(){var t=this,e=t._self._c;return e("div",[e("h3",{staticClass:"text-left pt-4 text-gray-500"},[t._v("搜尋結果")]),e("ul",{staticClass:"scroll-list"},[t._l(t.pageData,(function(t){return[e("bus-search-list-item",{key:t.RouteUID,attrs:{item:t}})]})),0===t.pageData.length?e("li",{staticClass:"no-data"},[e("p",[t._v("哎呀!查無結果")]),e("p",[t._v("請重新搜尋關鍵字或切換縣市")])]):t._e()],2)])},Ie=[],Ne=function(){var t=this,e=t._self._c;return e("li",{staticClass:"rounded-md pl-4 py-2 border-line border-b text-left relative cursor-pointer",on:{click:function(e){return t.toBusRoute()}}},[e("h3",{staticClass:"font-bold text-black"},[t._v(" "+t._s(t.item.RouteName.Zh_tw)+" ")]),e("p",{staticClass:"text-gray-500 text-sm"},[t._v(" "+t._s(t.item.DepartureStopNameZh)+" "),e("span",[t._v(" - ")]),t._v(" "+t._s(t.item.DestinationStopNameZh)+" ")]),e("img",{staticClass:"w-6 absolute right-2 top-4",attrs:{src:"images/arrow/arrow-right-light.svg",alt:""}})])},Ce=[],De={props:{item:{type:Object,default:()=>{}}},methods:{toBusRoute(){const{DepartureStopNameZh:t,DestinationStopNameZh:e,RouteName:s,RouteUID:a,City:o}=this.item;this.$router.push({path:"/busroute",query:{routeUID:a,routeName:s.Zh_tw,city:o,to:t,back:e}})}}},Pe=De,$e=Object(u["a"])(Pe,Ne,Ce,!1,null,null,null),Me=$e.exports,Te={components:{BusSearchListItem:Me},props:{pageData:{type:Array,default:()=>[]}}},Oe=Te,Be=Object(u["a"])(Oe,_e,Ie,!1,null,null,null),Re=Be.exports,ze=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"fixed bottom-0 left-0 w-full p-2 h-56 flex justify-between flex-wrap bg-gray-300 border-t border-gray-500 md:absolute"},[t._l(t.keyBoardList,(function(s){return e("li",{key:s.value,staticClass:"keyboard-item",style:{color:s.style?s.style:"#37206D"},on:{click:function(e){s.fn?t.handleFunction(s.fn):t.setRouteName(s.value)}}},[t._v(" "+t._s(s.value)+" ")])})),e("li",{staticClass:"keyboard-item bg-gray-400",on:{click:t.deleteRouteName}},[e("img",{attrs:{src:"images/Keyboard-delete.svg",alt:""}})])],2)},Ue=[],Ee={name:"Home",components:{},props:{keyword:{type:String,default:""}},computed:{keyBoardList(){return this.keyBoardShow?this.keyList:this.keyList2}},data(){return{keyBoardShow:!0,keyList:[{value:"紅",style:"#FB5B44",fn:""},{value:"藍",style:"#448DFB",fn:""},{value:"1",style:"",fn:""},{value:"2",style:"",fn:""},{value:"3",style:"",fn:""},{value:"綠",style:"#59DD86",fn:""},{value:"棕",style:"#D4A274",fn:""},{value:"4",style:"",fn:""},{value:"5",style:"",fn:""},{value:"6",style:"",fn:""},{value:"橘",style:"#FB9232",fn:""},{value:"黃",style:"#ECC94C",fn:""},{value:"7",style:"",fn:""},{value:"8",style:"",fn:""},{value:"9",style:"",fn:""},{value:"更多",style:"#6F7585",fn:"ctrlKeyboard"},{value:"幹線",style:"",fn:""},{value:"0",style:"",fn:""},{value:"重設",style:"#6F7585",fn:"reset"}],keyList2:[{value:"市民",style:"",fn:""},{value:"捷運",style:"",fn:""},{value:"貓空",style:"",fn:""},{value:"A",style:"",fn:""},{value:"F",style:"",fn:""},{value:"內科",style:"",fn:""},{value:"高鐵",style:"",fn:""},{value:"跳蛙",style:"",fn:""},{value:"L",style:"",fn:""},{value:"R",style:"",fn:""},{value:"南軟",style:"",fn:""},{value:"快線",style:"",fn:""},{value:"JOY",style:"",fn:""},{value:"E",style:"",fn:""},{value:"T",style:"",fn:""},{value:"返回",style:"gray",fn:"ctrlKeyboard"}]}},methods:{setRouteName(t){this.$emit("setRouteName",t)},deleteRouteName(){this.$emit("deleteRouteName")},reset(){this.$emit("reset")},ctrlKeyboard(){this.keyBoardShow=!this.keyBoardShow},handleFunction(t){this[t]()}}},Ze=Ee,Ae=Object(u["a"])(Ze,ze,Ue,!1,null,"7551ad1c",null),Fe=Ae.exports,Ye=function(){var t=this,e=t._self._c;return e("div",{staticClass:"touch-ball fixed md:absolute right-2 top-32",on:{click:t.ctrlKeyboard}},[t.inView?e("img",{attrs:{src:`images/${t.showKeyboard?"keyboard":"command"}.svg`,alt:""}}):e("p",{staticClass:"text-gray-500"},[t._v("TOP")])])},He=[],Ke={props:{showKeyboard:{type:Boolean,default:!1}},data(){return{inView:!0,scrollContainer:null}},methods:{ctrlKeyboard(){this.inView&&this.$emit("ctrlKeyboard"),this.inView||this.scrollContainer.scrollTo({top:0,left:0,behavior:"smooth"})},scrollEvent(){this.inView=this.scrollContainer.scrollTop<=this.scrollContainer.offsetHeight}},mounted(){this.scrollContainer=document.querySelector(".scroll-list"),this.scrollContainer.addEventListener("scroll",this.scrollEvent)},beforeDestroy(){this.scrollContainer.removeEventListener("scroll",this.scrollEvent)}},Ve=Ke,qe=Object(u["a"])(Ve,Ye,He,!1,null,"2703bf07",null),Ge=qe.exports,Je=function(){var t=this,e=t._self._c;return e("div",{class:t.setClass,attrs:{id:"map"}})},We=[];let Qe=null,Xe=null,ts=null,es=null,ss=null,as=null,os=null;var is={props:{mapInfo:{type:Array,default:()=>[]},setClass:{type:String,default:""}},data(){return{}},methods:{createMap(){let t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Qe=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(Qe),Xe=Q().addTo(Qe),es=(new V.a.MarkerClusterGroup).addTo(Qe),this.setView(25.033876641528444,121.56456344001262)},cleanMarker(){Xe.clearLayers(),Qe.eachLayer(t=>{t instanceof V.a.Marker&&Qe.removeLayer(t)})},cleanBus(){es.clearLayers()},setView(t,e){Qe.setView([t,e],16)},createMark(){ss=new V.a.Icon({iconUrl:"images/mark/bus.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),as=new V.a.Icon({iconUrl:"images/mark/BusStop-start.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),os=new V.a.Icon({iconUrl:"images/mark/BusStop-end.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawMark(t){var e,s,a,o;const i=[...t];let n=i.shift(),r=i.pop();Xe.addLayer(V.a.marker([null===n||void 0===n||null===(e=n.StopPosition)||void 0===e?void 0:e.PositionLat,null===n||void 0===n||null===(s=n.StopPosition)||void 0===s?void 0:s.PositionLon],{icon:as}).bindPopup(` <h2 class="title">${n.StopName.Zh_tw}</h2>`)),Xe.addLayer(V.a.marker([null===r||void 0===r||null===(a=r.StopPosition)||void 0===a?void 0:a.PositionLat,null===r||void 0===r||null===(o=r.StopPosition)||void 0===o?void 0:o.PositionLon],{icon:os}).bindPopup(` <h2 class="title">${r.StopName.Zh_tw}</h2>`)),i.forEach((t,e)=>{let{PositionLat:s,PositionLon:a}=t.StopPosition;Xe.addLayer(V.a.marker([s,a],{icon:new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:`\n                            <div class="w-16 h-14 relative flex justify-center items-center">\n                                <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                                <span class="text-light font-bold text-base text-center relative z-10 pb-2">${e+1}</span>\n                            </div>`})}))}),Qe.addLayer(Xe)},drawBus(t){this.cleanBus(),t.forEach(t=>{let{PositionLat:e,PositionLon:s}=t.BusPosition,{PlateNumb:a}=t;es.addLayer(V.a.marker([e,s],{icon:ss}).bindPopup(`\n                            <h2 class="title">${a}</h2>\n                        `))}),Qe.addLayer(es)},drawLine(t){const e=new ce["Wkt"];e.read(t);const s=e.toJson(),a={color:"#7550cc",weight:3};ts=V.a.geoJSON(s,{style:a}).addTo(Qe),ts.addData(s),Qe.fitBounds(ts.getBounds()),Qe.addLayer(ts)}},mounted(){this.createMark(),this.createMap()},beforeDestroy(){Qe=null,Xe=null,ts=null,es=null}},ns=is,rs=Object(u["a"])(ns,Je,We,!1,null,"3e81a2ee",null),ls=rs.exports,cs={components:{KeyBoard:Fe,BusSearchList:Re,BusSearchBtn:Ge,MapSearchs:ls,Footer:P,Header:R},data(){return{CITY_LIST:St,city:St[0].value,routeName:"",busList:[],showKeyboard:!1,pageData:[],endFlag:!1,debounce:null}},computed:{liveBus(){return this.busList.filter(t=>t.PlateNumb)},showSearch(){return this.routeName.length>0}},methods:{async getRoute(){const t={city:this.city,$filter:this.routeName?`contains(RouteName/Zh_tw, '${this.routeName}')`:""};try{const e=await Dt(t);this.busList=e,this.pageData=[],this.splitData()}catch(e){console.log("error",e)}this.setView()},splitData(){0===this.busList.length&&(this.endFlag=!0);const t=this.busList.splice(0,30);this.pageData=this.pageData.concat(t)},setRouteName(t){this.routeName+=t,this.getRoute()},deleteRouteName(){this.routeName=this.routeName.substring(0,this.routeName.length-1),this.routeName||this.getRoute()},keyIn(t){clearTimeout(this.debounce),this.debounce=setTimeout(()=>{this.routeName=t.target.value,this.getRoute()},600)},reset(){this.routeName="",this.getRoute()},ctrlKeyboard(){this.showKeyboard=!this.showKeyboard,this.showKeyboard||this.$refs.inputRouteName.focus()},scrollEvent(){if(this.endFlag)return;const t=document.querySelector(".scroll-list");t.scrollTop===t.scrollHeight-t.offsetHeight&&this.splitData()},setView(){const{pos:t}=St.find(t=>t.value===this.city),{lat:e,lon:s}=t;this.$refs.mapSearch.setView(e,s)}},mounted(){this.getRoute();const t=document.querySelector(".scroll-list");t.addEventListener("scroll",this.scrollEvent)},beforeDestroy(){const t=document.querySelector(".scroll-list");t.removeEventListener("scroll",this.scrollEvent)}},us=cs,ds=(s("26b5"),Object(u["a"])(us,je,Le,!1,null,null,null)),hs=ds.exports,ps=function(){var t=this,e=t._self._c;return e("div",[e("Header"),e("map-searchs",{ref:"mapSearch",attrs:{setClass:"for-web"}}),e("div",{staticClass:"side-block pt-10 px-4"},[e("h2",{staticClass:"py-4 text-gray-500 text-left"},[t._v("我的最愛")]),e("ul",{staticClass:"scroll-list"},[t._l(t.favoriteList,(function(t){return[e("bus-search-list-item",{key:t.RouteUID,attrs:{item:t}})]}))],2)]),e("Footer")],1)},ms=[],fs={components:{BusSearchListItem:Me,MapSearchs:ls,Footer:P,Header:R},computed:{...Object(ct["b"])(["favoriteList"])}},bs=fs,vs=Object(u["a"])(bs,ps,ms,!1,null,null,null),gs=vs.exports,ys=function(){var t=this,e=t._self._c;return e("div",[e("Header"),e("map-near",{ref:"mapNear",on:{setStop:t.setStop,getNowPos:t.getNowPos}}),e("div",{staticClass:"right-0 z-50 touch-ball top-72 md:left-0 md:top-48",on:{click:t.focusSelf}},[e("img",{attrs:{src:"images/cursor.svg",alt:""}})]),e("div",{staticClass:"panel side-block",style:{transform:"translateY("+this.moveY+"vh)","transition-duration":"0.3s"}},[e("div",{staticClass:"h-10 md:hidden",on:{click:t.ctrlPanel}},[e("div",{staticClass:"w-10 h-0.5 bg-gray-400 m-auto"})]),t.showNearStation?e("bus-near-list",{attrs:{stopList:t.stopList,direction:t.direction},on:{selectStop:t.selectStop}}):e("bus-near-estimate",{attrs:{direction:t.direction,stopInfo:t.stopInfo},on:{goBack:t.goBack}})],1),e("Footer")],1)},ws=[],Ss=function(){var t=this,e=t._self._c;return e("div",{staticClass:"md:px-4"},[e("h2",{staticClass:"py-4 text-gray-400 text-left"},[t._v("最近站牌")]),e("ul",{staticClass:"relative scroll-list z-30 w-full"},[t._l(t.stopList,(function(s,a){return e("li",{key:s.StationUID,staticClass:"p-2 my-2 border border-purple-300 cursor-pointer rounded-lg text-left",on:{click:function(e){return t.selectStop(s)}}},[e("h3",{staticClass:"font-bold text-black py-2"},[e("span",[t._v(t._s(a+1))]),t._v(" "+t._s(s.StationName.Zh_tw)+" "),e("span",{staticClass:"rounded-full bg-gray-400 px-2 py-1 text-sm text-white"},[t._v(" "+t._s(t.direction[s.Bearing])+" ")])]),e("p",{staticClass:"text-primary-700"},[t._v(" "+t._s(t.transRoute(s.Stops))+" ")])])})),0===t.stopList.length?e("li",{staticClass:"no-data"},[t._v("附近找不到站牌")]):t._e()],2)])},xs=[],ks={props:{stopList:{type:Array,default:()=>[]},direction:{type:Object,default:()=>{}}},data(){return{}},methods:{selectStop(t){this.$emit("selectStop",t)},transRoute(t){const e=t.map(t=>t.RouteName.Zh_tw);return e.join(",")}}},js=ks,Ls=(s("6411"),Object(u["a"])(js,Ss,xs,!1,null,"07e335b7",null)),_s=Ls.exports,Is=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"map"}})},Ns=[];let Cs=null,Ds=null,Ps=null,$s=null;var Ms={data(){return{}},methods:{createMap(){let t="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";Cs=V.a.map("map"),V.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:t}).addTo(Cs);let e=Q();Ds=(new V.a.MarkerClusterGroup).addTo(Cs),Ps=e.addTo(Cs),this.$emit("getNowPos")},cleanMarker(){Ds.clearLayers(),Cs.eachLayer(t=>{t instanceof V.a.Marker&&Cs.removeLayer(t)})},cleanStation(){Ps.clearLayers()},setView(t,e,s=16){Cs.setView([t,e],s)},createMark(){$s=new V.a.Icon({iconUrl:"images/mark/TrackingSpot.svg",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},drawSelfMark(t,e){Ds.addLayer(V.a.marker([t,e],{icon:$s})),Cs.addLayer(Ds),this.setView(t,e)},drawStation(t){this.cleanStation(),t.forEach((t,e)=>{let{PositionLat:s,PositionLon:a}=t.StationPosition;const o=new V.a.DivIcon({className:"bus-icon",iconAnchor:[12,40],html:`\n                    <div class="w-16 h-14 relative flex justify-center items-center">\n                        <img class="absolute w-full block" src="images/mark/BusStop_blank.svg"/>\n                        <span class="text-light font-bold text-base text-center relative z-10 pb-4">${e+1}</span>\n                    </div>\n                    `});Ps.addLayer(V.a.marker([s,a],{icon:o}).on("click",this.markerOnClick))}),Cs.addLayer(Ps)},markerOnClick(t){const{lat:e,lng:s}=t.latlng;this.$emit("setStop",{lat:e,lng:s})}},mounted(){this.createMark(),this.createMap()},beforeDestroy(){Cs=null,Ds=null,Ps=null}},Ts=Ms,Os=Object(u["a"])(Ts,Is,Ns,!1,null,"4f8d6a4b",null),Bs=Os.exports,Rs=function(){var t=this,e=t._self._c;return e("div",[e("img",{staticClass:"py-2 cursor-pointer",attrs:{src:"images/arrow/back.svg",alt:""},on:{click:t.goBack}}),e("h3",{staticClass:"font-bold text-black py-2"},[t._v(" "+t._s(t.stopInfo&&t.stopInfo.StationName.Zh_tw)+" "),e("span",{staticClass:"rounded-full bg-gray-400 px-2 py-1 text-sm text-white"},[t._v(" "+t._s(t.stopInfo&&t.direction[t.stopInfo.Bearing])+" ")])]),e("ul",{staticClass:"scroll-list"},[t._l(t.timeList,(function(t,s){return[e("bus-near-estimate-item",{key:t.RouteUID,attrs:{order:s+1,itemData:t}})]}))],2),e("div",{staticClass:"line"})])},zs=[],Us={components:{BusNearEstimateItem:Yt},props:{stopInfo:{type:Object,default:()=>{}},direction:{type:Object,default:()=>{}}},computed:{...Object(ct["b"])(["terminalList"])},watch:{stopInfo(){this.stopInfo&&(this.getNearEstimated(),this.getDataByTimer())}},data(){return{timer:null,listType:0,second:60,timeList:[],initFlag:!1}},methods:{goBack(){this.$emit("goBack")},getDataByTimer(){clearInterval(this.timer),this.timer=setInterval(()=>{this.second-=1,this.second<=0&&(this.second=60,this.getNearEstimated())},1e3)},async getNearEstimated(){const{PositionLat:t,PositionLon:e}=this.stopInfo.StationPosition;this.$bus.$emit("setLoading",!0);const s={$spatialFilter:`nearby(${t},${e}, 30)`};try{const t=await Ot(s);this.timeList=t,this.timeList.length>0&&this.getDataByTimer(),!this.initFlag&&this.getBusInfo()}catch(a){console.log("error",a)}this.$bus.$emit("setLoading",!1)},async getBusInfo(){let t=[...this.timeList];for(let s=0;s<t.length;s++){const{RouteUID:t}=this.timeList[s],a=t.substr(0,3),{value:o}=St.find(t=>t.ISO===a);if(this.terminalList[t])return;const i={city:o,$filter:`contains(RouteUID,\n                            '${t}')`};try{const e=await Dt(i),{DepartureStopNameZh:s,DestinationStopNameZh:a,City:o,RouteName:n}=e[0];this.$store.commit("updateTerminalList",{RouteName:n.Zh_tw,RouteUID:t,DestinationStopNameZh:a,DepartureStopNameZh:s,City:o})}catch(e){console.log("error",e)}}this.initFlag=!0}},mounted(){this.getNearEstimated(),this.getDataByTimer()},beforeDestroy(){clearInterval(this.timer)}},Es=Us,Zs=Object(u["a"])(Es,Rs,zs,!1,null,null,null),As=Zs.exports,Fs={inject:["appData"],components:{BusNearList:_s,MapNear:Bs,BusNearEstimate:As,Footer:P,Header:R},data:function(){return{moveY:60,stopList:[],timeList:[],routeList:[],stopInfo:{},showNearStation:!0,selfPos:{},direction:{E:"東行",W:"西行",S:"南行",N:"北行",SE:"東南行",NE:"東北行",SW:"西南行",NW:"西北行"}}},computed:{stationIDList(){return this.stopList.map(t=>t.StationID)},isMobile(){var t;return(null===(t=this.appData)||void 0===t?void 0:t.windowSize)<780}},watch:{isMobile:{immediate:!0,handler(t){t||(this.moveY=0)}}},methods:{getNowPos(){navigator.geolocation&&(this.$bus.$emit("setLoading",!0),navigator.geolocation.getCurrentPosition(t=>{const e=t.coords.longitude,s=t.coords.latitude;this.selfPos={latitude:s,longitude:e},this.getNearStop(s,e),this.$refs.mapNear.drawSelfMark(s,e),this.$bus.$emit("setLoading",!1)},t=>{const{code:e,message:s}=t;this.getNearStop(25.047675,121.517055),this.$bus.$emit("setLoading",!1),console.log("error",`code=${e},\n                            msg=${s}`)}))},focusSelf(){const{latitude:t,longitude:e}=this.selfPos;this.$refs.mapNear.setView(t,e)},async getNearStop(t,e){const s={$spatialFilter:`nearby(${t},${e}, 500)`};try{const t=await Tt(s);console.log("this.stopList",t),this.stopList=this.filterReapeatList(t),this.$refs.mapNear.drawStation(this.stopList)}catch(a){console.log("error",a)}},filterReapeatList(t){const e=[];return t?t.filter(t=>{if(!e.includes(t.StationID))return e.push(t.StationID),t}):[]},selectStop(t){const{PositionLat:e,PositionLon:s}=t.StationPosition;this.stopInfo=t,this.showNearStation=!1,this.$refs.mapNear.setView(e,s,18)},ctrlPanel(){this.moveY=60===this.moveY?10:60},goBack(){this.showNearStation=!0,this.focusSelf()},setStop(t){const{lat:e,lng:s}=t,a=this.stopList.find(t=>{const{PositionLat:a,PositionLon:o}=t.StationPosition;return a===e&&o===s});this.stopInfo=a,this.showNearStation=!1,this.$refs.mapNear.setView(e,s,18)}}},Ys=Fs,Hs=Object(u["a"])(Ys,ys,ws,!1,null,null,null),Ks=Hs.exports;a["a"].use(k["a"]);const Vs=[{path:"/",name:"Index",component:Qt},{path:"/busroute",name:"BusRoute",component:ke},{path:"/bussearch",name:"BusSearch",component:hs},{path:"/favorite",name:"Favorite",component:gs},{path:"/busnear",name:"BusNear",component:Ks}],qs=new k["a"]({routes:Vs});var Gs=qs,Js=s("bfa9");a["a"].use(ct["a"]);const Ws=new Js["a"]({storage:window.localStorage,reducer:t=>({favoriteList:t.favoriteList,terminalList:t.terminalList})}),Qs=()=>({favoriteList:[],terminalList:[]});var Xs=new ct["a"].Store({state:Qs,mutations:{updateFavoriteList(t,e){const{RouteUID:s}=e,a=t.favoriteList.findIndex(t=>t.RouteUID===s);a>=0?t.favoriteList.splice(a,1):t.favoriteList.push(e)},updateTerminalList(t,e){const{RouteUID:s,RouteName:o,DestinationStopNameZh:i,DepartureStopNameZh:n,City:r}=e;a["a"].set(t.terminalList,s,{RouteName:o,DestinationStopNameZh:i,DepartureStopNameZh:n,City:r})}},actions:{},modules:{},plugins:[Ws.plugin]}),ta=s("a584"),ea=(s("96b1"),s("6cc5"),s("8243"),s("3ac1"),s("7319"),s("b9eb")),sa=s.n(ea),aa=s("ecee"),oa=s("c074"),ia=s("ad3d");a["a"].component("font-awesome-icon",ia["a"]),a["a"].component("pagination",sa.a),aa["c"].add(oa["a"]),a["a"].config.productionTip=!1,a["a"].use(ta["a"],{config:{id:"G-N2LJBT6101"}});const na=async()=>{if(console.log("test",(new Date).getTime()<=Number(localStorage.getItem("expireTime"))),(new Date).getTime()/1e3<=Number(localStorage.getItem("expireTime")))return;const t=await zt();t.access_token&&(localStorage.setItem("token",t.access_token),localStorage.setItem("expireTime",(new Date).getTime()/1e3+t.expires_in))};na(),a["a"].prototype.$bus=new a["a"],new a["a"]({router:Gs,store:Xs,render:t=>t(x)}).$mount("#app")},5789:function(t,e,s){"use strict";s("a340")},6411:function(t,e,s){"use strict";s("343e")},"703f":function(t,e,s){},"7c80":function(t,e,s){},"90e7":function(t,e,s){"use strict";s("3696")},"96b1":function(t,e,s){},"9f31":function(t,e,s){"use strict";s("c1e0")},a340:function(t,e,s){},adda:function(t,e,s){},b29f:function(t,e,s){"use strict";s("d30c")},c1e0:function(t,e,s){},d2f6:function(t,e,s){},d30c:function(t,e,s){},d5f7:function(t,e,s){},d6f1:function(t,e,s){"use strict";s("adda")}});